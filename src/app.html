<template>
  <require from="./app.css"></require>
  <require from="./modalCustomElement"></require>
  <require from="ObjectKeysValueConverter"></require>
  <require from="SortedObjectKeysValueConverter"></require>
  <div class="outer ${theme}">
  <style type="text/css">${activeCSS}</style>
  <div class="container ${wait?'wait':''}">
  <div class="header">
  	  <div class="headerBlock" click.trigger="fetchContext(defaultPage,'card')">
	      <img src="${defaultIcon}" class="headerLogo link"/>
	  	  <div class="bannerText">${defaultLabel}</div>
  	 </div>
  	 <div class="headerBlock">
	  	  <input type="search" value.bind="q" input.delegate="fetchSearch()" placeholder="Search"/>
	   	  <div class="actions mobile" if.bind="loginData.status">
	   	  		<select value.bind="activeGraph" class="classSelector" change.delegate="selectGraph(activeGraph)">
	   	  			<option value="">All Graphs</option>
	   	  			<option repeat.for="graphType of instanceList['class:_Graph']['rdf:type']" value.bind="graphType.curie">${graphType.label}</option>
	   	  		</select>	   	  	
	   	  		<select value.bind="activeClass" class="classSelector" change.delegate="activateClass(activeClass,'classAction:_View')">
	   	  			<option disabled="disabled" value="">Select a class:</option>
	   	  			<option value="class:_Class">Class</option> 
	   	  			<option value="class:_Property">Property</option> 
	   	  			<option disabled="disabled" value="">──────────────────</option>
	   	  			<option repeat.for="classType of instanceList['class:_Class']['rdf:type']" value.bind="classType.curie">${classType.label}</option>
	   	  		</select>
	   	  		<select value.bind="classAction" class="classSelector" change.delegate="activateClass(activeClass,classAction)">
	   	  			<option value="classAction:_View">View</option> 
	   	  			<option value="classAction:_New">New</option> 
	   	  		</select>
	   	  		<div class="button" click.trigger="activateClass(activeClass,classAction)">Go</div>
	   	  </div>
   	  </div>	
   	  <div class="headerBlock mobile">
   	  	<div class="userFullName">${loginData.data['term:prefLabel'][0].value}</div>
   	  	<div class="button mobile" click.trigger="login()" if.bind="!loginData.status">Log in</div>
   	  	<div class="button mobile" click.trigger="logout()" if.bind="loginData.status">Log out</div>


   	  </div>  	  
  </div>
  <div class="paneContainer">
  <div class="horizontalPanes">	
  <div class="leftPane">
<!--	<div class="byline"> </div>
	<div class="topics"> </div>
	<div class="previousPage"></div>-->
  </div>	
  <div class="centerPane">
  <div class="display">
  	  <div class="modeFrame">
  	  <div class="modeButtons">
  	  	   <div class="button" click.trigger="showMenu=!showMenu">&#x2261; Menu</div>
  	  	   <div class="mainMenu ${showMenu?'visible':''}" click.trigger="showMenu=false" blur.trigger="showMenu=false"> </div>
  	  	   <!--<div class="button ${mode==='list'?'selected':''}" click.trigger="setMode('list')">Links</div>-->
  	  	   <div class="button ${mode==='card'?'selected':''}" click.trigger="setMode('card')">Content</div>
  	  	   <div class="button ${mode==='properties'?'selected':''}" click.trigger="setMode('properties')">Properties</div>
  	  	   <div class="button ${mode==='graph'?'selected':''}" click.trigger="setMode('graph')">Graph</div>
<!--  	  	   <div class="button ${mode==='images'?'selected':''}" click.trigger="setMode('images')">Images</div>-->
<!--  	  	   <div class="button ${mode==='compliance'?'selected':''}" click.trigger="setMode('compliance')">Compliance</div> -->
<!--  	  	   <div class="button ${mode==='ingestion'?'selected':''}" click.trigger="setMode('ingestion')">Ingestion</div>-->
 	  	   <div class="button ${mode==='sparql'?'selected':''}" click.trigger="setMode('sparql')" if.bind="userRole.has('accountRole:_Sparql')">SPARQL</div>
 	  	   <!--<div class="button ${mode==='widgets'?'selected':''}" click.trigger="setMode('widgets')">Widgets <span class="${widgets.count>0?'activeLight':'inactiveLight'}">&#9830;</span></div>--> 	  	   
 	  	   <div class="button ${mode==='namespaces'?'selected':''}" click.trigger="setMode('namespaces')" if.bind="userRole.has('accountRole:_Sparql')">
Namespaces</div>
 	  	   <div class="button ${mode==='search'?'selected':''}" click.trigger="setMode('search')" if.bind="mode==='search'">Search</div>
	   	  <!--<div class="button" click.trigger="fetchContext('page:_About','list',{predicate:'term:hasFolderPage',sortMode:'sortMode:_AlphaAsc'})">About</div>-->
	  	<div class="button" click.trigger="goBack()">Back</div>
	  	<div class="button" click.trigger="goForward()">Forward</div>
   	  	<div class="button" click.trigger="launchService()" if.bind="loginData.status">JSON</div>
		<div class="button" click.trigger="launchSeo()" if.bind="loginData.status">SEO</div>
		<div class="button" click.trigger="launchPage()" if.bind="loginData.status">New Tab</div>
		<div class="button" click.trigger="pinPage(true)" if.bind="loginData.status">Refresh</div>
		<div class="button" click.trigger="cache='cached'" if.bind="loginData.status">Cache</div>

   	  </div>
      </div>


<!--	<div class="properties"  if.bind="mode==='properties' && !cardEdit">
	  	<div class="type link" click.trigger="fetchContext(g[context]['rdf:type'][0].value,'list')">${g[g[context]['rdf:type'][0].value]['term:prefLabel'][0].value}</div>
		<div class="propertyContextLabel">${g[context]['term:prefLabel'][0].value}</div>
		<div class="buttons">
			<div class="button" click.trigger="editCardProperties()" if.bind="userValidated">Edit</div>
		</div>
		<div class="property" repeat.for="property of keys(g[context], ['term:prefLabel','term:hasPrimaryImageURL','term:hasDescription','term:inGlossary', 
		'term:hasSearchable'])">
		  	<div class="label" title="${property}"
		  	>${titleCase((g[property]['term:prefLabel'])?g[property]['term:prefLabel'][0].value:property)}:&nbsp;</div>
		  	<div class="valueBlock">
			  	<div class="value" repeat.for="item of wrapArray(g[context][property])">
			  		<span class="link" if.bind="item.type==='uri'" click.trigger="fetchContext(item.value)">${g[item.value]['term:prefLabel'][0].value}<span if.bind="!$last">,&nbsp;</span>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal'" title="${item.datatype}"><span innerhtml="${displayLiteral(item)}"
			  			css="item.datatype.startsWith('xsd:textLiteral')?'display:block;word-space:pre':''"></span> 
			  			<span class="link" click.trigger="fetchContext(item.datatype)" if.bind="g[item.datatype]['term:prefLabel'].length > 0 ">[${g[item.datatype]["term:prefLabel"][0].value}]</span><span if.bind="!$last && $index != 0">, </span>
			  		</span>
			  	</div>
		    </div>
		  </div>
		</div>-->

    <div class="properties"  if.bind="mode==='properties' && !cardEdit">
	  	<div class="type link" click.trigger="fetchContext(g[context]['rdf:type'][0].value,'list')">${g[g[context]['rdf:type'][0].value]['term:prefLabel'][0].value}</div>
		<div class="propertyContextLabel">${g[context]['term:prefLabel'][0].value}</div>
		<div class="buttons">
			<div class="button" click.trigger="editCardProperties()" if.bind="userValidated">Edit</div>
		</div>
		<div class="property" repeat.for="property of predicates" if.bind="g[context][property.curie].length > 0">
		  	<div class="label" title="${property.curie}"
		  	>${property.fullLabel}</div>
		  	<div class="valueBlock">
			  	<div class="value" repeat.for="item of g[context][property.curie]">
			  		<span class="link" if.bind="property.nodeKind === 'nodeKind:_IRI'" click.trigger="fetchContext(item.value)">${g[item.value]['term:prefLabel'][0].value}<span if.bind="!$last">,&nbsp;</span>
			  		</span>
			  		<span class="value" if.bind="property.nodeKind === 'nodeKind:_Literal'" title="${item.datatype}"><span innerhtml="${displayLiteral(item)}"
			  			css="item.datatype.startsWith('xsd:textLiteral')?'display:block;word-space:pre':''"></span> 
			  			<span class="link" click.trigger="fetchContext(item.datatype)" if.bind="g[item.datatype]['term:prefLabel'].length > 0 ">[${g[item.datatype]["term:prefLabel"][0].value}]</span> <span if.bind="!$last && $index != 0">, </span>
			  		</span>
			  	</div>
		    </div>
		  </div>
		</div>

	<div class="properties"  if.bind="mode==='properties' && cardEdit">
		<div class="propertyContextLabel">${g[context]['term:prefLabel'][0].value}</div>
		<div class="buttons">
			<div class="button" click.trigger="saveCardProperties()">Save</div>
			<div class="button" click.trigger="addProperty()">Add Property</div>
			<div class="button" click.trigger="revertCard()">Revert</div>
		</div>
<!--		<div class="property" repeat.for="property of keys(g[context], ['term:prefLabel','term:hasPrimaryImageURL','term:hasDescription','term:inGlossary','term:hasSearchable'])"
		    >-->
		    <div class="property" repeat.for="property of keys(g[context], ['term:prefLabel','term:hasPrimaryImageURL','term:hasDescription','term:inGlossary','term:hasSearchable'])"
		    >

		  	<div class="label" title="${property}">${g[g[property]['rdfs:domain'][0].value]['term:prefLabel'][0].value} ${titleCase((g[property]['term:prefLabel'])?g[property]['term:prefLabel'][0].value:property)}:&nbsp;</div>
		  	<div class="valueBlock">
			  	<div class="value" repeat.for="item of wrapArray(g[context][property])">
			  		<div class="link" if.bind="item.type==='uri'" if.bind="linkPropertyList[property]||[]>0">
			  			<!--<select value="${item.value}" mouseover.trigger="getTerms(property)" if.bind="!item.deleted"
			  					change.delegate="updateLink(context,property,item,$event)">
			  				<option value="${item.value}" selected="selected">${item.label}</option>
			  				<option repeat.for="term of linkPropertyList[property]||[]" value.bind="term.context" if.bind="term.context != item.value">${term.value}</option>
			  			</select>-->
			  			<span class="link">${item.label}</span>
			  			<button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</div>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype === 'currency:_USD'" title="${item.datatype}">
			  			$<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype === 'currency:_EUR'" title="${item.datatype}">
			  			&#8364;<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype === 'xsd:dateTime'" title="${item.value}"> 
			  			<input type="dateTime" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype === 'xsd:date'" title="${item.value}"> 
			  			<input type="date" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<div class="valueImages" if.bind="item.type==='literal' && item.datatype === 'xsd:imageURL'" title="${item.value}">
			  			<img src="${item.value}" class="imageMedium"/> 
			  			<div><input type="text" value.bind = "item.value" class="longInput"/>
			  		    <button click.trigger="deleteItem($index,g[context][property])">X</button>
			  			</div>
			  		</div>
			  		<div class="value" if.bind="item.type==='literal' && item.datatype === 'xsd:anyURI'" title="${item.value}">
			  			<div><input type="text" value.bind = "item.value" class="longInput"/>
			  		    <button click.trigger="deleteItem($index,g[context][property])">X</button>
			  			</div>
			  		</div>
			  		<div class="value" if.bind="item.type==='literal' && item.datatype === 'xsd:anyURL'" title="${item.value}">
			  			<div><input type="text" value.bind = "item.value" class="longInput"/>
			  		    <button click.trigger="deleteItem($index,g[context][property])">X</button>
			  			</div>
			  		</div>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('identifier:')" title="${item.value}">
			  			<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('unit:')" title="${item.value}">
			  			<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:string')" title="${item.value}">
			  			<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:curie')" title="${item.value}">
			  			<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:hours')" title="${item.value}">
			  			<input type="text" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:integer')" title="${item.value}">
			  			<input type="number" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:float')" title="${item.value}">
			  			<input type="number" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:currency_usd')" title="${item.value}">
			  			<input type="number" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:htmlLiteral')" title="${item.value}">
				  		<div class="bodyEditor" innerhtml.two-way="item.value" contenteditable="true"></div>
				  		<button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:textLiteral')" title="${item.value}">
				  		<textarea class="bodyEditor" value.bind="item.value"></textarea>
				  		<button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>

			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:gYear')" title="${item.value}">
			  			<input type="number" value.bind = "item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:hexColor')" title="${item.value}">
			  			<input type="color" value.bind = "item.value"/><input type="string" value.bind="item.value"/><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal' && item.datatype.startsWith('xsd:boolean')" title="${item.value}">
			  			<select value.bind="item.value">
			  				<option value="true">Yes</option>
			  				<option value="false">No</option>
			  			</select><button click.trigger="deleteItem($index,g[context][property])">X</button>
			  		</span>
			  	</div>
			  	<button click.trigger="addProperty(property)"><span>&#8226;</span></button>
				<!--<button click.trigger = "addExistingPropertyValue(property)" repeat.for="cardinality of g[property]['property:hasCardinality']"
				 if.bind="cardinality.value === 'cardinality:_ZeroOrMore' || cardinality.value === 'cardinality:_OneOrMore'">+</button>-->
		    </div>
		  </div>
		</div>

	  <div class="list" if.bind="(['list','images']).includes(mode)">
	  	<!--<div class="type link" click.trigger="fetchContext(g[context]['rdf:type'][0].value,'list')">${g[g[context]['rdf:type'][0].value]['term:prefLabel'][0].value}</div>-->
		<h1 class="propertyContextLabel">${g[context]['term:prefLabel'][0].value||'Loading ...'}</h1>
		<div class="imageHeader">
			<div>
				<img class="cardImage" src="${g[context]['term:hasPrimaryImageURL'][0].value||missingImage}"/>
				<div class="largeColorSwatch" css="background-color:${g[context]['color:hasColorHexValue'][0].value}" if.bind="g[context].hasOwnProperty('color:hasColorHexValue')">&nbsp;</div>
			</div> 
		  	<div class="summaryContainer">
				<div class="summary" innerHTML="${g[context].hasOwnProperty('term:hasSummary')?g[context]['term:hasSummary'][0].value:summaryFilter(g[context]['term:hasDescription'][0].value)}"> </div>
				<div class="button" click.trigger="fetchContext(context,'card')">Read More</div>
				<div class="button" click.trigger="launchURL(g[context]['term:hasExternalURL'][0].value)"
	if.bind="g[context]['term:hasExternalURL'][0].value != ''">See Source</div>
	  	  	   <!--<div class="button ${mode==='graph'?'selected':''}" click.trigger="setMode('graph')">Graph</div>-->
			</div>
			<ul class="backLinks" if.bind="loginData.status">
				<li class="backLink" 
					repeat.for="predicate of keys(g[context],['term:hasPublicationStatus'])"
					if.bind="(g[context][predicate][0].type === 'uri')">
					<span>${g[predicate]['term:prefLabel'][0].value}</span>
					<span class="link" click.trigger="fetchContext(object.value,'card')"
					 repeat.for="object of wrapArray(g[context][predicate])"
					>${g[object.value]['term:prefLabel'][0].value}<span if.bind="!$last">, </span></span>
				</li>
			</ul>
		</div>

<!--		<ul class="backLinks">
			<li class="backLink" 
				repeat.for="predicate of keys(g[context],['term:hasPublicationStatus','rdfs:subClassOf','term:hasSourceTerm'])"
				if.bind="g[context][predicate][0].type === 'uri'">
				<span>${g[predicate]['term:prefLabel'][0].value}</span>
				<span class="link" click.trigger="fetchContext(object.value,'list')"
				 repeat.for="object of wrapArray(g[context][predicate])"
				>${g[object.value]['term:prefLabel'][0].value}<span if.bind="!$last">, </span></span>
			</li>
		</ul>		
	  	<div class="imageHeader">
		  	<div class="imageContainer">
		  		<img src.bind="g[context]['term:hasPrimaryImageURL'][0].value" class="thumbImage"/>
		  	</div>
		  	<div class="summaryContainer">
				<div class="summary" innerhtml.bind="summary(g[context]['term:hasDescription'][0].value)"> </div>
				<div class="button" click.trigger="fetchContext(context,'card')">More</div>
			</div>
		</div>-->			  		


	  	<div class="buttons"  if.bind="userRole.has('accountRole:_Create')">
		  	<div class="button" click.trigger="newCard()" if.bind="context.startsWith('class:') && userRole.has('accountRole:_Create')">New ${g[context]['term:prefLabel'][0].value}</div>
		  	<div class="button" click.trigger="newCard(context,true)" if.bind="context.startsWith('class:') && userRole.has('accountRole:_Create')">New Property</div>
		  	<!--<div class="button" click.trigger="newCard(g[activeLinkPredicate]['rdfs:domain'][0].value,false,context)" if.bind="(!context.startsWith('class:')) && userRole.has('accountRole:_Create')">New ${g[g[activeLinkPredicate]['rdfs:domain'][0].value]['term:prefLabel'][0].value}</div>-->
  		  	<div class="button" click.trigger="newCard(preferredClass.curie,false,preferredProperty||activeLinkPredicate,context)" if.bind="(!context.startsWith('class:')) && userRole.has('accountRole:_Create')" repeat.for="preferredClass of getPreferredClasses(context)">New ${preferredClass.label}</div>
	 		<div class="button" click.trigger="editCard('edit')" if.bind="userRole.has('accountRole:_Edit')">Edit</div>
			<div class="button" click.trigger="editCard('duplicate')" if.bind="userRole.has('accountRole:_Edit')">Duplicate</div>
			<div class="button" click.trigger="deleteCard()" if.bind="userRole.has('accountRole:_Delete') && (context != 'class:_Class') && (context != 'class:_Property')">Delete</div>
 		  	
		  	<div class="button" click.trigger="deleteClassItems(false)" if.bind="context.startsWith('class:') && userRole.has('accountRole:_Delete')  && (context != 'class:_Class') && (context != 'class:_Property')">Clear Items In ${g[context]['term:prefLabel'][0].value}</div>
		  	<div class="button" click.trigger="deleteClassItems(true)" if.bind="context.startsWith('class:') && userRole.has('accountRole:_Delete')  && (context != 'class:_Class') && (context != 'class:_Property')">Delete Class, Properties and Items In ${g[context]['term:prefLabel'][0].value}</div>
		</div>

	  <!--<div class="tabs">
	     <div class="tab ${(predicate.curie === activeLinkPredicate)?'active':''}" repeat.for="predicate of filterListPredicates(predicates)" click.trigger="activateTab(predicate.curie)"
	     if.bind="filterListPredicates(predicates).length>0"
	     title="${predicate.curie}">
		   ${predicate.domainLabel } ${predicate.label} ${g[context].hasOwnProperty('class:hasPluralName')?g[context]['class:hasPluralName'][0].value:g[context]['term:prefLabel'][0].value}
		  </div>
	  </div>-->	
	  <div class="listRefine" if.bind="activePredicates.length>0">

	  		<div class="property">
	  			<span class="label">Sort Order</span>
	  				<select value.bind="sortMode" change.delegate="sort()">
			  			<option repeat.for="sortModeState of sortModeStates" value.bind = "sortModeState.value">${sortModeState.label}</option>
			  		</select>
	  		</div>
	  		<div class="property">
	  			<span class="label">Refine</span>
		  		<input type="search" class="value" value.bind="qRefine" placeholder="Search in List" input.delegate="activateTab(activeLinkPredicate,true)"/>
		  	</div>
	  	</div>

	  		<div class="itemCount" if.bind="loginData.status && activeLinksData.count>0">Total Number of Items = ${activeLinksData.count}</div>
<!--		  	<div class="constraintsBlock" >
		  		<div class="buttons">
		  			<button click.trigger="newConstraint()" class="button">Add Constraint</button>
		  			<button click.trigger="clearConstraints()" class="button">Clear Constraints</button>
		  		</div>
		  		<div class="contraints">
		  			<div class="constraint property" repeat.for="constraint of constraints">
		  				<button click.trigger="removeConstraint($index)">X</button>
		  				<div class="constraintProperty label">&nbsp;${constraint.label}: &nbsp;</div>
		  				<div class="constraintValue value">${constraint.objectLabel}</div>
		  			</div>
		  		</div>
		  	</div>-->
	  	<!-- links.sjs implementation -->
	  <div class="tabs predicateTabs"  if.bind='predicates.length>0'>
	  	 <!--<div class="button" title="This hides or shows the properties that dictate what gets seen in the list view. This is useful for better exploring the information space."
	  	 click.trigger="showProperties = ! showProperties" class="settingsIcon"><img src="https://cdn3.iconfinder.com/data/icons/musthave/256/Settings.png" class="settingsIcon"/></div>-->
	  	 <select value.bind="activeLinkPredicate" change.delegate="activateTab(activeLinkPredicate)" click.trigger="activateTab(activeLinkPredicate)"  class="classSelector" if.bind="showProperties">
<!--	  	 	 <option  repeat.for="predicate of activePredicates" if.bind="showProperties" value.bind="predicate.curie" >Each Item ${article(titleCase(predicate.label),g[context]['term:prefLabel'][0].value)} ${g[context]['term:prefLabel'][0].value}</option> -->
				 <option  repeat.for="predicate of activePredicates" if.bind="showProperties && predicate.curie != 'rdf:type'" value.bind="predicate.curie" >${predicate.domainLabel}s</option>
				 <option  repeat.for="predicate of activePredicates" if.bind="showProperties && predicate.curie === 'rdf:type'" value.bind="predicate.curie">${g[context]['class:hasPluralName'][0].value}</option>
	  	 </select>
	  </div>
	  	<div class="linksContainer"  if.bind="mode === 'list'">
	  		<div class="linkContainer" repeat.for="item of activeLinksData.data" if.bind="loginData.status || (!loginData.status && item.publicationStatus === 'publicationStatus:_Published')">
	  			<div class="link iconContainer"><div class="iconSubcontainer"><img src="${item.image||missingImage}" click.trigger="fetchContext(item.link,'list')" class="linkImage"/></div>
	  			<!--<div  class="link colorIcon "
	  			if.bind="g[link].hasOwnProperty('color:hasColorHexValue')"
	  			 click.trigger="fetchContext(link,'list')"
	  			css="background-color:${g[link]['color:hasColorHexValue'][0].value}">&nbsp;</div>-->
	  		</div>
	  		<div class="linkMeta">
		  		<span click.trigger="fetchContext(item.link,'list')" class="link">${item.linkLabel}</span>
		  		<div class="linkDate">${displayLiteral({value:item.lastModifiedDate,type:'literal',datatype:'xsd:dateTime'})}</div>
		  		<div class="linkDescription" innerHTML="${item.summary != null?item.summary:summaryFilter(item.description)}"></div>
		  		<div class="button" click.delegate="launchPage(item.link,'card')" if.bind="loginData.status">Content</div>
				<div class="button" click.delegate="launchPage(item.link,'properties')"
		  			 if.bind="loginData.status">Properties</div>
		  		<div class="button" if.bind="loginData.status">${item.publicationStatus.split(':_')[1]}</div>	 
	  		</div>
  		</div>
  	</div>
	 <div class="imageFrame" if.bind="mode === 'images'">
	  	<div repeat.for="item of activeLinksData.data" class="imageContainer">
	  		<div class="imagesEntry">
	  		<img src.bind="item.image||missingImage" click.trigger="fetchContext(item.link,'list')" class="thumbImage link"
	  		title.bind="item.linkLabel"/>
	  		<!--<div click.trigger="fetchContext(item.link,'list')" class="link imageCaption">${item.linkLabel}.&nbsp;</div>-->
	  		</div>
	  	</div>
	  </div>


	  	<div class="pager" if.bind="!(activeLinksData.page >= activeLinksData.totalPages) &&  activeLinksData.count>0"><span class="link" click.trigger="setPage(1)">|&#9664;</span> <span class="link" click.trigger="prevRefPage()">&#9664;</span> Page ${page} of ${totalPages} <span class="link" click.trigger="nextRefPage()">&#9654;</span> <span class="link" click.trigger="setPage(totalPages)">&#9654;|</span></div>

	  </div> 






	<div if.bind="mode==='graph'">
 	  <div class="graphBody">
	 	  <div class="notice">Click nodes once to expand graph, twice to jump to node entry.</div>
	 	  <div class="graphBar">
	 	  <button click.trigger="graphToContext()">Go</button>
	 	  <input keyup.delegate="graphQ($event)" value.bind="qGraph" title="Filter links to selected node. Press RETURN to retrieve."></button>
	 	</div>
	  </div>
 	  <!--<div><input type="search" placeholder="Refine the selected item." value.bind="qGraph" input.delegate="searchGraph()"></input></div>-->
 	  <div class="iframeContainer"><iframe src="${server}/app/graphview/index.html?context=${context}" class="graph" id="graph"></iframe></div>
 	</div>


   <div class="card"  if.bind="(mode==='card') && (cardEdit === false)">
   	<!--<div class="topBanner link" innerhtml.bind="topBannerMessage" click.trigger="fetchContext(defaultPage)"></div>-->	
	<div class="buttons" if.bind="userValidated">	
	    <div class="button" click.trigger="newCard()" if.bind="context.startsWith('class:')">New ${g[context]['term:prefLabel'][0].value}</div>
<!--	    <div class="button" click.trigger="newCard(g[context]['rdf:type'][0].value)" if.bind="!context.startsWith('class:')  && userRole.has('accountRole:_Create')">New ${g[g[context]['rdf:type'][0].value]['term:prefLabel'][0].value}</div>-->
	  	<div class="button" click.trigger="newCard(preferredClass.curie,false,preferredProperty||activeLinkPredicate,context)" if.bind="(!context.startsWith('class:'))" repeat.for="preferredClass of getPreferredClasses(context)">New ${preferredClass.label}</div>
		<!--<div class="button" click.trigger="editCard('edit')" if.bind="userRole.has('accountRole:_Edit')">Edit</div>-->
		<div class="button" click.trigger="editCard('edit')" if.bind="userRole.has('accountRole:_Edit')">Edit</div>
		<div class="button" click.trigger="editCard('duplicate')" if.bind="userRole.has('accountRole:_Edit')">Duplicate</div>
		<div class="button" click.trigger="deleteCard()" if.bind="userRole.has('accountRole:_Delete') && (context != 'class:_Class') && (context != 'class:_Property')">Delete</div>
		<!--<div class="button" click.trigger="newCard()" if.bind="context.startsWith('class:') && userRole.has('accountRole:_Create')">New ${g[context]['term:prefLabel'][0].value}</div>-->
		<div class="button" click.trigger="newCard(context,true)" if.bind="context.startsWith('class:')">New Property</div>
		<!--<div class="button" click.trigger="launchPage()">External</div>-->
	</div>
   	<div class="widgetsContainer" innerhtml.bind="widgets.output.join('')" if.bind="!loginData.status">&nbsp;</div>
   	<div if.bind="loginData.status  || widgets.count === 0">
	<div class="pageNavigators">
		<div class="button" if.bind="g[context].hasOwnProperty('page:hasPreviousPage') && g[context]['page:hasPreviousPage'][0].value != 'page:_'" click.trigger="fetchContext(g[context]['page:hasPreviousPage'][0].value)">Previous Page</div>
		<div class="button" if.bind="g[context].hasOwnProperty('page:hasNextPage') && g[context]['page:hasNextPage'][0].value != 'page:_'" click.trigger="fetchContext(g[context]['page:hasNextPage'][0].value)">Next Page</div>		
	</div>
	<div class="imageHeader">
		<div>
			<img class="cardImage" src="${g[context]['term:hasPrimaryImageURL'][0].value||missingImage}"/>
			<div class="largeColorSwatch" css="background-color:${g[context]['color:hasColorHexValue'][0].value}" if.bind="g[context].hasOwnProperty('color:hasColorHexValue')">&nbsp;</div>
		</div>
		<div> 
		<ul class="backLinks" ><span class="title">${g[context]['term:prefLabel'][0].value}</span>
			<li class="backLink" 
				repeat.for="predicate of keys(g[context],['term:hasPublicationStatus'])"
				if.bind="g[context][predicate][0].type === 'uri'">
				<span>${g[predicate]['term:prefLabel'][0].value}</span>
				<span class="link" click.trigger="fetchContext(object.value,'card')"
				 repeat.for="object of wrapArray(g[context][predicate])"
				>${g[object.value]['term:prefLabel'][0].value}<span if.bind="!$last">, </span></span>
			</li>
		</ul>
		<!--<div class="button" click.trigger="fetchContext(context,'list')">Links</div>-->
  	  	<!--<div class="button ${mode==='graph'?'selected':''}" click.trigger="setMode('graph')">Graph</div>-->
		</div>
	</div>
  	<!--<div class="type link" click.trigger="fetchContext(g[context]['rdf:type'][0].value,'list')">${g[g[context]['rdf:type'][0].value]['term:prefLabel'][0].value}</div>-->
	<h1>${g[context]?g[context]['term:prefLabel'][0].value:"Loading"}</h1>
	<div class="description  expanded">
		<div class="bodyDisplay" repeat.for="descrKey of ['term:hasDescription']" innerHTML="${filterBody(g[context][descrKey][0].value)}"></div>
		<div class="button" click.trigger="launchURL(g[context]['term:hasExternalURL'][0].value)"
		if.bind="g[context]['term:hasExternalURL'][0].value != ''">See Source</div>
	</div>
	<hr/>
    </div>

<!-- Start links -->
	  <div class="tabs predicateTabs"  if.bind='predicates.length>0'>
	  	 <!--<div class="button" title="This hides or shows the properties that dictate what gets seen in the list view. This is useful for better exploring the information space."
	  	 click.trigger="showProperties = ! showProperties" class="settingsIcon"><img src="https://cdn3.iconfinder.com/data/icons/musthave/256/Settings.png" class="settingsIcon"/></div>-->
	  	 <select value.bind="activeLinkPredicate" change.delegate="activateTab(activeLinkPredicate)" click.trigger="activateTab(activeLinkPredicate)"  class="classSelector" if.bind="showProperties">
			 <option  repeat.for="predicate of activePredicates" if.bind="showProperties" value.bind="predicate.curie" ><div class="predicateTarget">${predicate.dropLabel}</div></option>
	  	 </select>
	  </div>	    
	  <div class="listRefine" if.bind="activePredicates.length>0">

	  		<div class="property">
	  			<span class="label">Sort Order</span>
	  				<select value.bind="sortMode" change.delegate="sort()">
			  			<option repeat.for="sortModeState of sortModeStates" value.bind = "sortModeState.value">${sortModeState.label}</option>
			  		</select>
	  		</div>
	  		<div class="property">
	  			<span class="label">Refine</span>
		  		<input type="search" class="value" value.bind="qRefine" placeholder="Search in List" input.delegate="activateTab(activeLinkPredicate,true)"/>
		  	</div>
		</div>
		<div class="constraintsBlock" if.bind="loginData.status">
		  		<div class="buttons">
		  			<button click.trigger="newConstraint()" class="button">Add Filter</button>
		  			<button click.trigger="clearConstraints()" class="button">Clear Filters</button>
		  		</div>
		  		<div class="contraints">
		  			<div class="constraint property" repeat.for="constraint of constraints">
		  				<button click.trigger="removeConstraint($index)">X</button>
		  				<div class="constraintProperty label">&nbsp;${constraint.label}: &nbsp;</div>
		  				<div class="constraintValue value">${constraint.objectLabel}</div>
		  			</div>
		  		</div>
		</div>	  	
	  	<div class="itemCount" if.bind="loginData.status && activeLinksData.count>0">Total Number of Items = ${activeLinksData.count}</div>
     	<div class="altLinksContent" innerhtml.bind="linksContent"></div>
	  	<div class="linksContainer"  if.bind="mode === 'card' && linksContent === ''">
	  		<div class="linkContainer" repeat.for="item of activeLinksData.data" if.bind="loginData.status || (!loginData.status && item.publicationStatus === 'publicationStatus:_Published')">
	  			<div class="link iconContainer"><div class="iconSubcontainer"><img src="${item.image||missingImage}" click.trigger="fetchContext(item.link,'card')" class="linkImage"/></div>
	  			<!--<div  class="link colorIcon "
	  			if.bind="g[link].hasOwnProperty('color:hasColorHexValue')"
	  			 click.trigger="fetchContext(link,'list')"
	  			css="background-color:${g[link]['color:hasColorHexValue'][0].value}">&nbsp;</div>-->
	  		</div>
	  		<div class="linkMeta"> 	
		  		<span click.trigger="fetchContext(item.link,'card')" class="link">${item.linkLabel}</span>
		  		<div class="linkDate">${displayLiteral({value:item.lastModifiedDate,type:'literal',datatype:'xsd:dateTime'})}</div>
		  		<div class="linkDescription" innerHTML="${item.summary != null?item.summary:summaryFilter(item.description)}"></div>
		  		<div class="button" click.trigger="deleteCard(item.link,item.linkType)" if.bind="userRole.has('accountRole:_Delete') && (context != 'class:_Class') && (context != 'class:_Property')">Delete</div>
		  		<div class="button" click.delegate="launchPage(item.link,'card')" if.bind="loginData.status">Content &#8594;</div>
				<div class="button" click.delegate="launchPage(item.link,'properties')"
		  			 if.bind="loginData.status">Properties &#8594;</div>
		  		<div class="button" if.bind="loginData.status">${item.publicationStatus.split(':_')[1]}</div>	 
	  		</div>
  		</div>
  	</div>
	 <div class="imageFrame" if.bind="mode === 'images'">
	  	<div repeat.for="item of activeLinksData.data" class="imageContainer">
	  		<div class="imagesEntry">
	  		<img src.bind="item.image||missingImage" click.trigger="fetchContext(item.link,'card')" class="thumbImage link"
	  		title.bind="item.linkLabel"/>
	  		<!--<div click.trigger="fetchContext(item.link,'list')" class="link imageCaption">${item.linkLabel}.&nbsp;</div>-->
	  		</div>
	  	</div>
	  </div>


	  	<div class="pager" if.bind="!(activeLinksData.page >= activeLinksData.totalPages) &&  activeLinksData.count>0"><span class="link" click.trigger="setPage(1)">|&#9664;</span> <span class="link" click.trigger="prevRefPage()">&#9664;</span> Page ${page} of ${totalPages} <span class="link" click.trigger="nextRefPage()">&#9654;</span> <span class="link" click.trigger="setPage(totalPages)">&#9654;|</span></div>

<!-- End links -->	
  </div>

  <div class="card"  if.bind="mode==='card' && cardEdit === true">
	<div class="buttons">
		<div class="button" click.trigger="saveCardProperties()" if.bind="editMode === 'edit'">Save</div>
		<div class="button" click.trigger="saveDuplicateCardProperties()" if.bind="editMode === 'duplicate'">Save</div>
		<div class="button" click.trigger="revertCard()">Cancel</div>
	</div>
	<div class="property">
		<div class="dlg-label">Title</div>
		<div if.bind="editMode === 'duplicate'" ><input type="text" class="cardTitle longInput" value.bind="activeCard.title" input.delegate="generateEntityId(context)"></div>
		<div if.bind="editMode === 'edit'" ><input type="text" class="cardTitle longInput" value.bind="activeCard.title"></input></div>
	</div>
	<div class="property">
		<div class="dlg-label">Curie</div>
		<div class="curie"><input value.bind="activeCard.curie"></div>
<!--		<div class="curie" contenteditable="true"  innerhtml.two-way="activeCard.curie" placeholder="Condensed URI or Curie"></div>-->
	</div>
	<img class="cardImage" src="${activeCard.image}"/>
	<div><span class="label">Image URL: </span><input value.two-way="activeCard.image" class="primaryImageEditField longInput" input.delegate="createImageFile(activeCard.curie)"/>
		<input type="file" change.trigger="setImage($event)"/>
	</div>
	<div class="property">
		<div class="dlg-label">External URL</div>
		<div class="dlg-value"><input value.two-way="activeCard.externalURL" class="longInput" title="Clear to remove link"/></div>
	</div>
	<div class="editorBlock">
		<div class="description expanded">
			<div class="bodyEditor" innerhtml.two-way="activeCard.body" contenteditable="true"></div>
		</div>
		<div class="editorButtonsPane">
		<div class="editorButtons">
			<button><img class="intLink" title="Undo" click.trigger="formatDoc('undo')" src="data:image/gif;base64,R0lGODlhFgAWAOMKADljwliE33mOrpGjuYKl8aezxqPD+7/I19DV3NHa7P///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARR8MlJq7046807TkaYeJJBnES4EeUJvIGapWYAC0CsocQ7SDlWJkAkCA6ToMYWIARGQF3mRQVIEjkkSVLIbSfEwhdRIH4fh/DZMICe3/C4nBQBADs=" /></button>
			<button><img class="intLink" title="Redo" click.trigger="formatDoc('redo')" src="data:image/gif;base64,R0lGODlhFgAWAMIHAB1ChDljwl9vj1iE34Kl8aPD+7/I1////yH5BAEKAAcALAAAAAAWABYAAANKeLrc/jDKSesyphi7SiEgsVXZEATDICqBVJjpqWZt9NaEDNbQK1wCQsxlYnxMAImhyDoFAElJasRRvAZVRqqQXUy7Cgx4TC6bswkAOw==" /></button>
			<button><img class="intLink" title="Bold" click.trigger="formatDoc('bold')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAInhI+pa+H9mJy0LhdgtrxzDG5WGFVk6aXqyk6Y9kXvKKNuLbb6zgMFADs=" /></button>
			<button><img class="intLink" title="Italic" click.trigger="formatDoc('italic')" src="data:image/gif;base64,R0lGODlhFgAWAKEDAAAAAF9vj5WIbf///yH5BAEAAAMALAAAAAAWABYAAAIjnI+py+0Po5x0gXvruEKHrF2BB1YiCWgbMFIYpsbyTNd2UwAAOw==" /></button>
			<button><img class="intLink" title="Underline" click.trigger="formatDoc('underline')" src="data:image/gif;base64,R0lGODlhFgAWAKECAAAAAF9vj////////yH5BAEAAAIALAAAAAAWABYAAAIrlI+py+0Po5zUgAsEzvEeL4Ea15EiJJ5PSqJmuwKBEKgxVuXWtun+DwxCCgA7" /></button>
			<button><img class="intLink" title="Left align" click.trigger="formatDoc('justifyleft')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JMGELkGYxo+qzl4nKyXAAAOw==" /></button>
			<button><img class="intLink" title="Center align" click.trigger="formatDoc('justifycenter')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIfhI+py+0Po5y02ouz3jL4D4JOGI7kaZ5Bqn4sycVbAQA7" /></button>
			<button><img class="intLink" title="Right align" click.trigger="formatDoc('justifyright')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JQGDLkGYxouqzl43JyVgAAOw==" /></button>
			<button><img class="intLink" title="Numbered list" click.trigger="formatDoc('insertorderedlist')" src="data:image/gif;base64,R0lGODlhFgAWAMIGAAAAADljwliE35GjuaezxtHa7P///////yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKSespwjoRFvggCBUBoTFBeq6QIAysQnRHaEOzyaZ07Lu9lUBnC0UGQU1K52s6n5oEADs=" /></button>
			<button><img class="intLink" title="Dotted list" click.trigger="formatDoc('insertunorderedlist')" src="data:image/gif;base64,R0lGODlhFgAWAMIGAAAAAB1ChF9vj1iE33mOrqezxv///////yH5BAEAAAcALAAAAAAWABYAAAMyeLrc/jDKSesppNhGRlBAKIZRERBbqm6YtnbfMY7lud64UwiuKnigGQliQuWOyKQykgAAOw==" /></button>
				<button><img class="intLink" title="Hyperlink" click.trigger="createHyperlink()" src="data:image/gif;base64,R0lGODlhFgAWAOMKAB1ChDRLY19vj3mOrpGjuaezxrCztb/I19Ha7Pv8/f///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARY8MlJq7046827/2BYIQVhHg9pEgVGIklyDEUBy/RlE4FQF4dCj2AQXAiJQDCWQCAEBwIioEMQBgSAFhDAGghGi9XgHAhMNoSZgJkJei33UESv2+/4vD4TAQA7" /></button>
			<button><img class="intLink" title="Quote" click.trigger="formatDoc('formatblock','blockquote')" src="data:image/gif;base64,R0lGODlhFgAWAIQXAC1NqjFRjkBgmT9nqUJnsk9xrFJ7u2R9qmKBt1iGzHmOrm6Sz4OXw3Odz4Cl2ZSnw6KxyqO306K63bG70bTB0rDI3bvI4P///////////////////////////////////yH5BAEKAB8ALAAAAAAWABYAAAVP4CeOZGmeaKqubEs2CekkErvEI1zZuOgYFlakECEZFi0GgTGKEBATFmJAVXweVOoKEQgABB9IQDCmrLpjETrQQlhHjINrTq/b7/i8fp8PAQA7" /></button>
			<button><img class="intLink" title="Add indentation" click.trigger="formatDoc('outdent')" src="data:image/gif;base64,R0lGODlhFgAWAMIHAAAAADljwliE35GjuaezxtDV3NHa7P///yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKCQG9F2i7u8agQgyK1z2EIBil+TWqEMxhMczsYVJ3e4ahk+sFnAgtxSQDqWw6n5cEADs=" /></button>
			<button><img class="intLink" title="Delete indentation" click.trigger="formatDoc('indent')" src="data:image/gif;base64,R0lGODlhFgAWAOMIAAAAADljwl9vj1iE35GjuaezxtDV3NHa7P///////////////////////////////yH5BAEAAAgALAAAAAAWABYAAAQ7EMlJq704650B/x8gemMpgugwHJNZXodKsO5oqUOgo5KhBwWESyMQsCRDHu9VOyk5TM9zSpFSr9gsJwIAOw==" /></button>
		
			<button><img class="intLink" title="Cut" click.trigger="formatDoc('cut')" src="data:image/gif;base64,R0lGODlhFgAWAIQSAB1ChBFNsRJTySJYwjljwkxwl19vj1dusYODhl6MnHmOrpqbmpGjuaezxrCztcDCxL/I18rL1P///////////////////////////////////////////////////////yH5BAEAAB8ALAAAAAAWABYAAAVu4CeOZGmeaKqubDs6TNnEbGNApNG0kbGMi5trwcA9GArXh+FAfBAw5UexUDAQESkRsfhJPwaH4YsEGAAJGisRGAQY7UCC9ZAXBB+74LGCRxIEHwAHdWooDgGJcwpxDisQBQRjIgkDCVlfmZqbmiEAOw==" /></button>
			<button><img class="intLink" title="Copy" click.trigger="formatDoc('copy')" src="data:image/gif;base64,R0lGODlhFgAWAIQcAB1ChBFNsTRLYyJYwjljwl9vj1iE31iGzF6MnHWX9HOdz5GjuYCl2YKl8ZOt4qezxqK63aK/9KPD+7DI3b/I17LM/MrL1MLY9NHa7OPs++bx/Pv8/f///////////////yH5BAEAAB8ALAAAAAAWABYAAAWG4CeOZGmeaKqubOum1SQ/kPVOW749BeVSus2CgrCxHptLBbOQxCSNCCaF1GUqwQbBd0JGJAyGJJiobE+LnCaDcXAaEoxhQACgNw0FQx9kP+wmaRgYFBQNeAoGihCAJQsCkJAKOhgXEw8BLQYciooHf5o7EA+kC40qBKkAAAGrpy+wsbKzIiEAOw==" /></button>
			<button><img class="intLink" title="Paste" click.trigger="formatDoc('paste')" src="data:image/gif;base64,R0lGODlhFgAWAIQUAD04KTRLY2tXQF9vj414WZWIbXmOrpqbmpGjudClFaezxsa0cb/I1+3YitHa7PrkIPHvbuPs+/fvrvv8/f///////////////////////////////////////////////yH5BAEAAB8ALAAAAAAWABYAAAWN4CeOZGmeaKqubGsusPvBSyFJjVDs6nJLB0khR4AkBCmfsCGBQAoCwjF5gwquVykSFbwZE+AwIBV0GhFog2EwIDchjwRiQo9E2Fx4XD5R+B0DDAEnBXBhBhN2DgwDAQFjJYVhCQYRfgoIDGiQJAWTCQMRiwwMfgicnVcAAAMOaK+bLAOrtLUyt7i5uiUhADs=" /></button>
			<button click.trigger="insertVideo()" class="editorButton"><img src="http://icons.iconarchive.com/icons/iconsmind/outline/256/Video-5-icon.png" class="intLink editorButtonImage"/></button>
			<button click.trigger="formatDoc('unlink')"><img src="https://cdn0.iconfinder.com/data/icons/website-kit-2/512/icon_342-512.png" class="intLink editorButtonImage"/></button>
			<button click.trigger="formatDoc('removeFormat')"><img src="https://cdn1.iconfinder.com/data/icons/text-and-typography-5-1/64/Text_and_Typography_339-512.png" class="intLink editorButtonImage"/></button>		
			<button click.trigger="formatDoc('insertHorizontalRule')"><img src="https://cdn1.iconfinder.com/data/icons/popular-user-interface-2/30/minus_dash_line_horizontal-512.png" class="intLink editorButtonImage" title="Insert Horizontal Rule"/></button>		
			<button click.trigger="imageEdit()"><img src="https://image.flaticon.com/icons/png/512/23/23765.png" class="intLink editorButtonImage"/></button>
			<input type="color" value="#ff0000" input.trigger="setForeColor($event)" alt="ForeColor"></input>
			<input type="color" value="#ffffff" input.trigger="setBackColor($event)" alt="BackColor"></input>
			<button click.trigger="insertCodeBlock()"><img src="http://www.iconarchive.com/download/i89195/icons8/ios7/Very-Basic-Code.ico" class="intLink editorButtonImage" title="Insert Code Block"/></button>
			<select value="" input.trigger="setHeading($event)">
				<option value="" disabled="disabled" selected="selected">Select Heading</option>
	            <option value="h1">Heading 1</option>
	            <option value="h2">Heading 2</option>
	            <option value="h3">Heading 3</option>
	            <option value="h4">Heading 4</option>
	            <option value="p">Paragraph</option>
	            <option value="pre">Code</option>
			</select>

			<button click.trigger="insertTermDlg()">Insert Term</button>
			<button class="editorButtonLong">&#8658;<img title="Convert To Rich Text" click.trigger="convertToRichText()" src="https://cdn3.iconfinder.com/data/icons/flat-design-development-set-1/24/control-rich-text-edit-512.png"  class="intLink editorButtonImage"/></button>
			<button class="editorButtonLong">&#8656;<img title="Convert From Rich Text" click.trigger="convertFromRichText()" src="https://cdn3.iconfinder.com/data/icons/flat-design-development-set-1/24/control-rich-text-edit-512.png"  class="intLink editorButtonImage"/></button>
			<button class="editorButtonLong" click.trigger="saveCardProperties()">Save</button>
		</div>
		</div>
	</div>
<!--	<div><button click.trigger="displayFullBody = true" if.bind="!displayFullBody">Expand</button><button click.trigger="displayFullBody = false" if.bind="displayFullBody">Collapse</button></div>-->
 </div>


 <div class="namespaces card" if.bind="mode==='namespaces'">
 		<h1 class="subhead">Namespaces</h1>

 		<table>
 		<tr>
 			<th>Prefix</th>
 			<th>Namespace</th>
 		</tr>	
 		<tr class="property" repeat.for="prefix of ns | sortedObjectKeys">
 			<td class="inlineLabel">${prefix}</td>
 			<td class="inlineValue">${ns[prefix]}></td>
 		</tr>
 		</table>
 </div>

	<div class="compliance card"  if.bind="mode==='compliance'">
		<h1>Compliance: ${g[context]['term:prefLabel'][0].value}</h1>
		<div class="property">
			<div class="label">For Country:</div>
			<div class="value"><select value.bind="complianceItem.country"
				change.delegate="filterComplianceTest()">>
				<option value="" disabled="disabled">Select the compliance country</option>
				<option value="country:_UnitedStates">United States</option>
				<option value="country:_EuropeanUnion">European Union</option>
				<option value.bind="item.curie" repeat.for="item of instanceList['class:_Country']['rdf:type']">${item.label}</option>
			</select></div>
		</div>
		<div class="property">
			<div class="label">Industry Use:</div>
			<div class="value"><select value.bind="complianceItem.industry"
				change.delegate="filterComplianceTest()">
				<option value="" disabled="disabled">Select the industry use.</option>
				<option value.bind="item.curie" repeat.for="item of instanceList['class:_Industry']['rdf:type']">${item.label}</option>
			</select></div>
			<div class="description" innerhtml.bind="getDescription(complianceItem.industry,'class:_Industry','rdf:type')"></div>
		</div>
		<div class="property">
			<div class="label">Compliance Test:</div>
			<div class="value"><select value.bind="complianceItem.complianceTest"  if.bind="instanceList['class:_ComplianceTest']['rdf:type'].length > 0">
				<option value="" disabled="disabled">Select the compliance test.</option>
				<option value.bind="item.curie" repeat.for="item of instanceList['class:_ComplianceTest']['rdf:type']">${item.label}</option>
			</select>
		</div>
		<div class="description" innerhtml.bind="getDescription(complianceItem.complianceTest,'class:_ComplianceTest','rdf:type')"
		 if.bind="instanceList['class:_ComplianceTest']['rdf:type'].length > 0" ></div>
		<div class="description" if.bind="instanceList['class:_ComplianceTest']['rdf:type'].length === 0" innerhtml.two-way="complianceItem.noItemsMessage"></div>
		<hr/>
		</div>
		<div class="property">
			<div class="label">Strain:</div>
			<div class="value"><select value.bind="complianceItem.strain"
				 change.delegate="updateInstanceList($event.target.value,'enzymeActivity:hasStrain')">
				<option value="" disabled="disabled">Select the strain.</option>
				<option value.bind="item.curie" repeat.for="item of instanceList['class:_Strain']['rdf:type']">${item.label}</option>
			</select></div>
		</div>
		<div class="property" if.bind="complianceItem.strain != ''">
			<div class="label">Enzyme Activity:</div>
			<div class="value"><select value.bind="complianceItem.enzyme"
				click.trigger="updateInstanceList($event.target.value,'grainProduct:hasEnzymeActivity')"
				change.delegate="updateInstanceList($event.target.value,'grainProduct:hasEnzymeActivity')">
				<option value="" disabled="disabled">Select the enzyme</option>
				<option value.bind="item.curie" selected="selected" repeat.for="item of instanceList[complianceItem.strain]['enzymeActivity:hasStrain']||[]">${item.label}</option>
			</select></div>

		</div>
		<div class="property" if.bind="complianceItem.enzyme != ''">
			<div class="label">Product:</div>
			<div class="value"><select value.bind="complianceItem.product">
				<option value.bind="item.curie" selected="selected" repeat.for="item of instanceList[complianceItem.enzyme]['grainProduct:hasEnzymeActivity']||[]">${item.label}</option>
			</select></div>
			
		</div>
	</div>


 <div class="ingestion card" if.bind="mode==='ingestion'">
 	<h1>Ingestion</h1>
 	<h2 class="subhead">Properties</h2>
 	<div repeat.for="sheet of templates | objectKeys" class="sheet">
 		<div class="sheetName">Worksheet '${sheet}'</div>
 		<div class="ingest property"><span class="label">Namespace:</span> <span class="value">${templates[sheet].uri}</span></div>
 		<details>
 			<summary>Sheet Properties</summary>
 			<div class="sheetProperty" repeat.for="sheetProperty of templates[sheet].headers">{{${sheetProperty}}}</div>
 		</details>
 		<div class="property">
 		<div class="label">Template</div>
 			<textarea value.bind="templates[sheet].template"></textarea>
 		</div>
 	</div>
 </div>
 <div class="search card" if.bind="mode==='search'">
 	<h1>Search</h1>
 	<p>${searchData.count} ${searchData.count === 1?'item':'items'} found.</p>
	<div repeat.for="item of searchData.results" class="searchItems" >
		<div class="searchItem link" click.trigger="fetchContext(item.s,'card')" title="${item.s}">
		<img src="${item.imageURL}" class="imageThumbnail"/>
		<div>${item.prefLabel} [${item.sTypeLabel}]</div>
		</div>
	</div> 	
 </div>
  
 <div class="sparql card" if.bind="mode==='sparql'">
 	<h1>SPARQL Query Page</h1>
 	<p>This is the future home of the SPARQL query page.</p>
 </div>

 <div class="widgets card" if.bind="mode==='widgets'">
 	<div class="widgetsContainer" innerhtml.bind="widgets.output.join('')"></div>
 </div>


  <!-- New Modal -- Dialog -->
  
  <modal view-model.ref="newModal" closed.delegate="processNewCard()" class="newModal">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel">New ${g[context]['term:prefLabel'][0].value}</div>
      <div class="button" click.trigger="newModal.cancel()">X</div>
    </div>
    <div class="dlgBody">
    <div class="dlg-property">	
  		<div class="dlg-label" title="This is the name of the ${g[context]['term:prefLabel'][0].value.toLowerCase()} used in the application. Avoid the use of the &amp; or &quot; characters in titles.">Title of ${g[context]['term:prefLabel'][0].value}</div>
    	<div class="cardTitleEdit"><input value.bind="activeCard.title" input.delegate="generateEntityId(context)" class="longInput" tabindex="0"/></div>
	</div>
	<div class="dlg-property"  if.bind="context === 'class:_User'">
	    <div class="dlg-property">	
	  		<div class="dlg-label" title="This is the username for the user.">Username</div>
	    	<div class="dlg-value"><input value.bind="activeCard.username" input.delegate="generateEntityId(context)" class="longInput" tabindex="0"/></div>
		</div>
	    <div class="dlg-property">	
	  		<div class="dlg-label" title="This is the password for the user.">Password</div>
	    	<div class="dlg-value"><input value.bind="activeCard.password" input.delegate="generateEntityId(context)" class="longInput" type="password" tabindex="0"/></div>
		</div>
	</div>
	<div class="dlg-property">
	<img class="cardImage" src="${activeCard.image}"/>
	<div><span class="label">Image URL </span><input value.bind="activeCard.image" class="primaryImageEditField longInput"  input.delegate="createImageFile(activeCard.curie)" tabindex="0"/>
		<input type="file" change.trigger="setImage($event)" tabindex="0"/>
	</div>
	</div>
	<div class="dlg-property"> 
  	<div class="dlg-label">Body</div>

	<div class="editorButtons">
		<button><img class="intLink" title="Undo" click.trigger="formatDoc('undo')" src="data:image/gif;base64,R0lGODlhFgAWAOMKADljwliE33mOrpGjuYKl8aezxqPD+7/I19DV3NHa7P///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARR8MlJq7046807TkaYeJJBnES4EeUJvIGapWYAC0CsocQ7SDlWJkAkCA6ToMYWIARGQF3mRQVIEjkkSVLIbSfEwhdRIH4fh/DZMICe3/C4nBQBADs=" /></button>
		<button><img class="intLink" title="Redo" click.trigger="formatDoc('redo')" src="data:image/gif;base64,R0lGODlhFgAWAMIHAB1ChDljwl9vj1iE34Kl8aPD+7/I1////yH5BAEKAAcALAAAAAAWABYAAANKeLrc/jDKSesyphi7SiEgsVXZEATDICqBVJjpqWZt9NaEDNbQK1wCQsxlYnxMAImhyDoFAElJasRRvAZVRqqQXUy7Cgx4TC6bswkAOw==" /></button>
		<button><img class="intLink" title="Bold" click.trigger="formatDoc('bold')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAInhI+pa+H9mJy0LhdgtrxzDG5WGFVk6aXqyk6Y9kXvKKNuLbb6zgMFADs=" /></button>
		<button><img class="intLink" title="Italic" click.trigger="formatDoc('italic')" src="data:image/gif;base64,R0lGODlhFgAWAKEDAAAAAF9vj5WIbf///yH5BAEAAAMALAAAAAAWABYAAAIjnI+py+0Po5x0gXvruEKHrF2BB1YiCWgbMFIYpsbyTNd2UwAAOw==" /></button>
		<button><img class="intLink" title="Underline" click.trigger="formatDoc('underline')" src="data:image/gif;base64,R0lGODlhFgAWAKECAAAAAF9vj////////yH5BAEAAAIALAAAAAAWABYAAAIrlI+py+0Po5zUgAsEzvEeL4Ea15EiJJ5PSqJmuwKBEKgxVuXWtun+DwxCCgA7" /></button>
		<button><img class="intLink" title="Left align" click.trigger="formatDoc('justifyleft')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JMGELkGYxo+qzl4nKyXAAAOw==" /></button>
		<button><img class="intLink" title="Center align" click.trigger="formatDoc('justifycenter')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIfhI+py+0Po5y02ouz3jL4D4JOGI7kaZ5Bqn4sycVbAQA7" /></button>
		<button><img class="intLink" title="Right align" click.trigger="formatDoc('justifyright')" src="data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JQGDLkGYxouqzl43JyVgAAOw==" /></button>
		<button><img class="intLink" title="Numbered list" click.trigger="formatDoc('insertorderedlist')" src="data:image/gif;base64,R0lGODlhFgAWAMIGAAAAADljwliE35GjuaezxtHa7P///////yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKSespwjoRFvggCBUBoTFBeq6QIAysQnRHaEOzyaZ07Lu9lUBnC0UGQU1K52s6n5oEADs=" /></button>
		<button><img class="intLink" title="Dotted list" click.trigger="formatDoc('insertunorderedlist')" src="data:image/gif;base64,R0lGODlhFgAWAMIGAAAAAB1ChF9vj1iE33mOrqezxv///////yH5BAEAAAcALAAAAAAWABYAAAMyeLrc/jDKSesppNhGRlBAKIZRERBbqm6YtnbfMY7lud64UwiuKnigGQliQuWOyKQykgAAOw==" /></button>
			<button><img class="intLink" title="Hyperlink" click.trigger="createHyperlink()" src="data:image/gif;base64,R0lGODlhFgAWAOMKAB1ChDRLY19vj3mOrpGjuaezxrCztb/I19Ha7Pv8/f///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARY8MlJq7046827/2BYIQVhHg9pEgVGIklyDEUBy/RlE4FQF4dCj2AQXAiJQDCWQCAEBwIioEMQBgSAFhDAGghGi9XgHAhMNoSZgJkJei33UESv2+/4vD4TAQA7" /></button>
		<button><img class="intLink" title="Quote" click.trigger="formatDoc('formatblock','blockquote')" src="data:image/gif;base64,R0lGODlhFgAWAIQXAC1NqjFRjkBgmT9nqUJnsk9xrFJ7u2R9qmKBt1iGzHmOrm6Sz4OXw3Odz4Cl2ZSnw6KxyqO306K63bG70bTB0rDI3bvI4P///////////////////////////////////yH5BAEKAB8ALAAAAAAWABYAAAVP4CeOZGmeaKqubEs2CekkErvEI1zZuOgYFlakECEZFi0GgTGKEBATFmJAVXweVOoKEQgABB9IQDCmrLpjETrQQlhHjINrTq/b7/i8fp8PAQA7" /></button>
		<button><img class="intLink" title="Add indentation" click.trigger="formatDoc('outdent')" src="data:image/gif;base64,R0lGODlhFgAWAMIHAAAAADljwliE35GjuaezxtDV3NHa7P///yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKCQG9F2i7u8agQgyK1z2EIBil+TWqEMxhMczsYVJ3e4ahk+sFnAgtxSQDqWw6n5cEADs=" /></button>
		<button><img class="intLink" title="Delete indentation" click.trigger="formatDoc('indent')" src="data:image/gif;base64,R0lGODlhFgAWAOMIAAAAADljwl9vj1iE35GjuaezxtDV3NHa7P///////////////////////////////yH5BAEAAAgALAAAAAAWABYAAAQ7EMlJq704650B/x8gemMpgugwHJNZXodKsO5oqUOgo5KhBwWESyMQsCRDHu9VOyk5TM9zSpFSr9gsJwIAOw==" /></button>
	
		<button><img class="intLink" title="Cut" click.trigger="formatDoc('cut')" src="data:image/gif;base64,R0lGODlhFgAWAIQSAB1ChBFNsRJTySJYwjljwkxwl19vj1dusYODhl6MnHmOrpqbmpGjuaezxrCztcDCxL/I18rL1P///////////////////////////////////////////////////////yH5BAEAAB8ALAAAAAAWABYAAAVu4CeOZGmeaKqubDs6TNnEbGNApNG0kbGMi5trwcA9GArXh+FAfBAw5UexUDAQESkRsfhJPwaH4YsEGAAJGisRGAQY7UCC9ZAXBB+74LGCRxIEHwAHdWooDgGJcwpxDisQBQRjIgkDCVlfmZqbmiEAOw==" /></button>
		<button><img class="intLink" title="Copy" click.trigger="formatDoc('copy')" src="data:image/gif;base64,R0lGODlhFgAWAIQcAB1ChBFNsTRLYyJYwjljwl9vj1iE31iGzF6MnHWX9HOdz5GjuYCl2YKl8ZOt4qezxqK63aK/9KPD+7DI3b/I17LM/MrL1MLY9NHa7OPs++bx/Pv8/f///////////////yH5BAEAAB8ALAAAAAAWABYAAAWG4CeOZGmeaKqubOum1SQ/kPVOW749BeVSus2CgrCxHptLBbOQxCSNCCaF1GUqwQbBd0JGJAyGJJiobE+LnCaDcXAaEoxhQACgNw0FQx9kP+wmaRgYFBQNeAoGihCAJQsCkJAKOhgXEw8BLQYciooHf5o7EA+kC40qBKkAAAGrpy+wsbKzIiEAOw==" /></button>
		<button><img class="intLink" title="Paste" click.trigger="formatDoc('paste')" src="data:image/gif;base64,R0lGODlhFgAWAIQUAD04KTRLY2tXQF9vj414WZWIbXmOrpqbmpGjudClFaezxsa0cb/I1+3YitHa7PrkIPHvbuPs+/fvrvv8/f///////////////////////////////////////////////yH5BAEAAB8ALAAAAAAWABYAAAWN4CeOZGmeaKqubGsusPvBSyFJjVDs6nJLB0khR4AkBCmfsCGBQAoCwjF5gwquVykSFbwZE+AwIBV0GhFog2EwIDchjwRiQo9E2Fx4XD5R+B0DDAEnBXBhBhN2DgwDAQFjJYVhCQYRfgoIDGiQJAWTCQMRiwwMfgicnVcAAAMOaK+bLAOrtLUyt7i5uiUhADs=" /></button>
		<button click.trigger="insertVideo()" class="editorButton"><img src="http://icons.iconarchive.com/icons/iconsmind/outline/256/Video-5-icon.png" class="intLink editorButtonImage"/></button>
		<button click.trigger="formatDoc('unlink')"><img src="https://cdn0.iconfinder.com/data/icons/website-kit-2/512/icon_342-512.png" class="intLink editorButtonImage"/></button>
		<button click.trigger="formatDoc('removeFormat')"><img src="https://cdn1.iconfinder.com/data/icons/text-and-typography-5-1/64/Text_and_Typography_339-512.png" class="intLink editorButtonImage"/></button>		
		<button click.trigger="formatDoc('insertHorizontalRule')"><img src="https://cdn1.iconfinder.com/data/icons/popular-user-interface-2/30/minus_dash_line_horizontal-512.png" class="intLink editorButtonImage" title="Insert Horizontal Rule"/></button>		
		<button click.trigger="imageEdit()"><img src="https://image.flaticon.com/icons/png/512/23/23765.png" class="intLink editorButtonImage"/></button>
		<input type="color" value="#ff0000" input.trigger="setForeColor($event)" alt="ForeColor"></input>
		<input type="color" value="#ffffff" input.trigger="setBackColor($event)" alt="BackColor"></input>
		<button click.trigger="insertCodeBlock()"><img src="http://www.iconarchive.com/download/i89195/icons8/ios7/Very-Basic-Code.ico" class="intLink editorButtonImage" title="Insert Code Block"/></button>
		<select value="" input.trigger="setHeading($event)">
			<option value="" disabled="disabled" selected="selected">Select Heading</option>
            <option value="h1">Heading 1</option>
            <option value="h2">Heading 2</option>
            <option value="h3">Heading 3</option>
            <option value="h4">Heading 4</option>
            <option value="p">Paragraph</option>
            <option value="pre">Code</option>
		</select>

		<button click.trigger="insertTermDlg()">Insert Term</button>
		<button class="editorButtonLong">&#8658;<img title="Convert To Rich Text" click.trigger="convertToRichText()" src="https://cdn3.iconfinder.com/data/icons/flat-design-development-set-1/24/control-rich-text-edit-512.png"  class="intLink editorButtonImage"/></button>
		<button class="editorButtonLong">&#8656;<img title="Convert From Rich Text" click.trigger="convertFromRichText()" src="https://cdn3.iconfinder.com/data/icons/flat-design-development-set-1/24/control-rich-text-edit-512.png"  class="intLink editorButtonImage"/></button>
	</div>


	<div class="bodyEditor newModalBE" innerhtml.two-way="activeCard.body" contenteditable="true"
	title="If your content is just text, type it in. If it's pasted HTML, then save the new item and use the HTML editor to paste the content in."
	 tabindex="0"> </div>
	</div>
	<div class="dlg-property"  if.bind="context === 'class:_Class'">
		<div class="dlg-property">
			<div class="dlg-label">Prefix</div>
			<div class="prefix" contenteditable="true"  innerhtml.two-way="activeCard.prefix" input.delegate="updateClassNamespace()" placeholder="Prefix" tabindex="0"></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Namespace</div>
			<div class="namespace" contenteditable="true"  innerhtml.two-way="activeCard.namespace" if.bind="context === 'class:_Class'" placeholder="Namespace" tabindex="0"></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Plural Form</div>
			<div class="namespace" contenteditable="true"  innerhtml.two-way="activeCard.plural" if.bind="context === 'class:_Class'" placeholder="Plural Form" tabindex="0"></div>
		</div>
<!--		<div class="dlg-property">
			<div class="dlg-label">Graph</div>
			<div class="dlg-value"><select value.bind="activeCard.graph" tabindex="0">
				<option value="" disabled="disabled">Select Graph</option>
				<option value.bind="link.curie" repeat.for="link of instanceList['class:_Graph']['rdf:type']">${link.label}</option>
			</select></div>
		</div> -->
	</div>
	<div class="dlg-property"  if.bind="context === 'class:_Property'">
		<div class="dlg-property">
			<div class="dlg-label">Domain</div>
			<div class="dlg-value"><select value.bind="activeCard.domain" change.delegate="generateEntityId(context)">
				<option value.bind="link.curie" repeat.for="link of instanceList['class:_Class']['rdf:type']" tabindex="0">${link.label}</option>
			</select></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Node Kind</div>
			<div class="dlg-value"><select value.bind="activeCard.nodeKind"  tabindex="0">
					<option value="" disabled="disabled">Choose whether the target is an attribute or an object.</option>
					<option value="nodeKind:_Literal">Attribute</option>
					<option value="nodeKind:_IRI">Object</option>
				</select></div>
			</div>
		<div class="dlg-property" if.bind="activeCard.nodeKind==='nodeKind:_IRI'">
			<div class="dlg-label">Range</div>
			<div class="dlg-value"><select value.bind="activeCard.range" tabindex="0">
				<option value.bind="link.curie" repeat.for="link of instanceList['class:_Class']['rdf:type']">${link.label}</option>
			</select></div>
		</div>
		<div class="dlg-property" if.bind="activeCard.nodeKind==='nodeKind:_Literal'" >
			<div class="dlg-label">Datatype</div>
			<div class="dlg-value"><select value.bind="activeCard.datatype" tabindex="0">
				<option value.bind="link.curie" repeat.for="link of instanceList['class:_XSD']['rdf:type']">${link.label}</option>
			</select></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Cardinality</div>
			<div class="dlg-value"><select value.bind="activeCard.cardinality" tabindex="0">
				<option value="" disabled="disabled">Select Cardinality</option>
				<option value.bind="link.curie" repeat.for="link of instanceList['class:_Cardinality']['rdf:type']">${link.label}</option>
			</select></div>
		</div>
	</div>
<!--	<div class="dlg-property">
		<div class="dlg-label">External URL:</div>
		<div class="dlg-value"><input value.two-way="activeCard.externalURL" class="longInput"/></div>
	</div>-->	
	<div class="dlg-property" repeat.for="property of templateProperties" if.bind="property.order != null">
		<div class="dlg-label">[${property.domainLabel}] ${property.label}</div>
		<div class="dlg-value" if.bind="property.nodeKind === 'nodeKind:_Literal' && property.datatype === 'xsd:string'"><input type="string" value.two-way="property.value" class="longInput"/></div>
		<div class="dlg-value" if.bind="property.nodeKind === 'nodeKind:_Literal' && property.datatype === 'xsd:date'"><input type="date" value.two-way="property.value" class="longInput"/></div>
		<div class="dlg-value" if.bind="property.nodeKind === 'nodeKind:_Literal' && property.datatype === 'xsd:dateTime'"><input type="dateTime" value.two-way="property.value" class="longInput"/></div>
		<div class="dlg-value" if.bind="property.nodeKind === 'nodeKind:_Literal' && property.datatype === 'xsd:integer'"><input type="number" value.two-way="property.value" class="longInput"/></div>
		<div class="dlg-value" if.bind="property.nodeKind === 'nodeKind:_IRI'"><select value.two-way="property.value" tabindex="0">
   	  		<option repeat.for="entity of property.entities" value.bind="entity.curie">${entity.label}</option>
		</select></div>
	</div>	
	<div class="dlg-property">
	<div><span class="label">File URL </span><input value.bind="activeCard.externalURL" class="primaryImageEditField longInput"  input.delegate="createFile(activeCard.curie)" tabindex="0"/>
		<input type="file" change.trigger="setFile($event)" tabindex="0"/>
	</div>
	</div>

	<div class="dlg-property">
		<div class="dlg-label">Curie</div>
<!--		<div class="curie" contenteditable="true"  innerhtml.two-way="activeCard.curie"></div>-->
		<div class="dlg-value"><input value.two-way="activeCard.curie" class="longInput" placeholder="Condensed URI or Curie" tabindex="0"></input></div>
	</div>
	<div class="dlg-property">
		<div class="dlg-label">Class</div>
		<div class="dlg-value"><select value.bind="activeCard.type" change.delegate="generateEntityId(activeCard.type)" tabindex="0">
			<option value="" disabled="disabled">Select Class</option>
   	  		<option repeat.for="action of instanceList['class:_Class']['rdf:type']" value.bind="action.curie">${action.label}</option>
		</select></div>
	</div>
	<div class="dlg-property">
		<div class="dlg-label">Template</div>
		<div class="dlag-value"><select value.bind="activeCard.template" change.delegate="setBodyToTemplate()" tabindex="0">
			<option value="">None</option>
			<option value.bind="template.link" repeat.for="template of availableTemplates">${template.linkLabel}</option>
		</select></div>
	</div>
	</div>
	<div class="modal-footer">
		<div class="button" click.trigger="newModal.close()" tabindex="0">Create</div>
		<div class="button" click.trigger="newModal.cancel()" tabindex="0">Cancel</div>
	</div>
  </modal>

  <modal view-model.ref="duplicateModal" closed.delegate="processDuplicateCard()">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel"><b>New ${g[context]['term:prefLabel'][0].value}</b></div>
      <div class="button" click.trigger="duplicateModal.cancel()">X</div>
    </div>
    <div>
	<div class="dlg-property">
		<div class="dlg-label">Title</div>
		<div class="dlg-value"><input value.two-way="activeCard.title"input.delegate="generateEntityId(context)"></input></div>
	</div>
	<div class="dlg-property">
		<img class="cardImage" src="${activeCard.image}"/>
		<div class="dlg-value"><span class="label">Image URL</span></div>
		<div class="dlg-label"><input value.two-way="activeCard.image" class="primaryImageEditField longInput"/></div>
	</div> 
	<div class="bodyEditor duplicateModalBE" innerhtml.two-way="activeCard.body" contenteditable="true"></div>
	<div class="dlg-property">
		<div class="dlg-label">Curie</div>
		<div class="dlg-value"><input value.two-way="activeCard.curie" input.delegate="generateEntityId(context)"></input></div>
	</div>
	</div>
	<div class="modal-footer">
		<div class="button" click.trigger="duplicateModal.close()">Save</div>
		<div class="button" click.trigger="duplicateModal.cancel()">Cancel</div>
	</div>
  </modal>

  <modal view-model.ref="addPropertyModal" closed.delegate="processAddProperty()">
	    <div slot="header" class="dlgHeader">
	      <div class="dlgHeaderLabel">Add property</div>
	      <div class="button" click.trigger="addPropertyModal.cancel()">X</div>
	     </div>
	    <div>
		<div class="dlg-property">
			<div class="dlg-label">Select Property</div>
			<div class="dlg-value"><select value.bind="selectedProperty" change.delegate="activePropertySelected($event)" tabindex="0">
				<option value="">None Selected</option>
				<option value.bind="property.predicate" repeat.for="property of availableProperties">[${property.domainLabel}] ${property.label}</option>
			</select></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_IRI'">
			<div class="dlg-label">Select Value</div>
			<div class="dlg-value"><select value.bind="activeProperty.value" tabindex="0">
				<option value="">None Selected</option>
				<option value.bind="value.curie" repeat.for="value of activePropertyValues">${value.label}</option>
			</select>
			<div class="button" click.trigger="launchPage(activeProperty.range,'card')">+</div>
		</div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && activeProperty.datatype ==='xsd:string'" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && activeProperty.datatype ==='xsd:curie'" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && ((activeProperty.datatype === 'xsd:integer') ||  (activeProperty.datatype === 'xsd:double') || (activeProperty.datatype === 'xsd:float'))" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" type="number" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && (activeProperty.datatype === 'xsd:currency_usd')" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" type="number" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && (activeProperty.datatype === 'xsd:currency_eur')" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" type="number" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && activeProperty.datatype ==='xsd:imageURL'" >
			<div class="dlg-label">Paste in Image URL:</div>
		    <img src.bind="activeProperty.value" class="imageMedium"/> 
			<div class="dlg-value"><input type="text" value.bind = "activeProperty.value" class="longInput" tabindex="0"/></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && activeProperty.datatype ==='xsd:htmlLiteral'" >
			<div class="dlg-label">HTML Content:</div>
			<div class="dlg-value" innerhtml.two-way="activeProperty.value" contenteditable="true" tabindex="0"></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && activeProperty.datatype ==='xsd:textLiteral'" >
			<div class="dlg-label">Multiline Text Content:</div>
			<div class="dlg-value textLiteralBlock" textcontent.bind="activeProperty.value" contenteditable="true" tabindex="0"></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_Literal' && (activeProperty.datatype === 'xsd:hexColor')" >
			<div class="dlg-label">Value:</div>
			<div class="dlg-value"><input value.bind="activeProperty.value" type="color" tabindex="0"></input></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind==='nodeKind:_Literal' && activeProperty.datatype === 'xsd:anyURI'" title="${activeProperty.value}">
			<div class="dlg-label">URL:</div>
  			<div><input type="text" value.bind = "activeProperty.value" class="longInput" tabindex="0"></input></div>
  		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind==='nodeKind:_Literal' && activeProperty.datatype === 'xsd:date'" title="${activeProperty.value}">
			<div class="dlg-label">URL:</div>
  			<div><input type="date" value.date = "activeProperty.value" class="longInput" tabindex="0"></input></div>
  		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind==='nodeKind:_Literal' && activeProperty.datatype === 'xsd:dateTime'" title="${activeProperty.value}">
			<div class="dlg-label">URL:</div>
  			<div><input type="dateTime" value.date = "activeProperty.value" class="longInput" tabindex="0"></input></div>
  		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="addPropertyModal.close()">Save</div>
		<div class="button" click.trigger="addPropertyModal.cancel()">Cancel</div>
	</div>
  </modal>

  <modal view-model.ref="addConstraintModal" closed.delegate="processAddConstraint()">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel">Add Constraint</div>
      <div class="button" click.trigger="addConstraintModal.cancel()">X</div>
    </div>

    <div>
		<div class="dlg-property">
			<div class="dlg-label">Select Property</div>
			<div class="dlg-value"><select value.bind="this.activeProperty" change.delegate="activePropertySelected($event)" tabindex="0">
				<option value="">None Selected</option>
				<option value.bind="property.predicate" repeat.for="property of availableProperties" if.bind="property.nodeKind === 'nodeKind:_IRI'">${property.label}</option>
			</select></div>
		</div>
		<div class="dlg-property" if.bind="activeProperty.nodeKind === 'nodeKind:_IRI'">
			<div class="dlg-label">Select Value</div>
			<div class="dlg-value"><select value.bind="activeProperty.value" tabindex="0">
				<option value="">None Selected</option>
				<option value.bind="value.curie" repeat.for="value of activePropertyValues">${value.label}</option>
			</select>
		</div>
		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="addConstraintModal.close()">Save</div>
		<div class="button" click.trigger="addConstraintModal.cancel()">Cancel</div>
	</div>
  </modal>

  <modal view-model.ref="insertTermModal" closed.delegate="insertTerm()" canceled.delegate="cancelInsertTerm()">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel">Insert Term</div>
      <div class="button" click.trigger="insertTermModal.cancel()">X</div>
    </div>

    <div>
			<!--  change.delegate="activeClassSelected($event)" -->
		<div class="dlg-property">
			<div class="dlg-label">Search</div>
			<div class="dlg-value"><input value.bind="q" type="text" input.delegate="inputSearch()" placeholder="Search for a term" tabindex="0"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Link</div>
				<div class="dlg-value"><select class="inputSearchList" value.bind="insertTermObj.value" change.delegate="updateInsertImage()" tabindex="0">
					<option value="" disabled="disabled">Search for an item above.</option>
					<option class="inputSearchItem link" value.bind="searchItem.s" repeat.for="searchItem of searchData.results" if.bind="$index<10">${searchItem.prefLabel} [${searchItem.sTypeLabel}]</option>
				</select>
				<div class="button" click.trigger="launchPage('class:_Topic','card')" tabindex="0">+</div>
			</div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Label:</div>
			<div class="dlg-value"><input value.bind="insertTermObj.temp" type="text"/><div class="button" click.trigger="updateInsertTerm()" tabindex="0">Use Term Label</div></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Image:</div>
			<div class="dlg-value"><img class="imageThumbnail" src.bind="insertTermObj.image" tabindex="0"/></div>
		</div>		
		<div class="dlg-property">
			<div class="dlg-label"><select value.bind="insertTermObj.asImage" tabindex="0">
				<option value="text">Insert As Linked Text</option>
				<option value="image">Insert As Image</option>
			</select></div>
		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="insertTermModal.close()">Insert</div>
		<div class="button" click.trigger="insertTermModal.cancel()">Cancel</div>
	</div>
  </modal>



    <modal view-model.ref="editImageModal" closed.delegate="processEditImage()">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel">Edit Image</div>
      <div class="button" click.trigger="editImageModal.cancel()">X</div>
    </div>
    <div>
    	<img src.bind="editImage.src"/>
		<div class="dlg-property">
			<div class="dlg-label">Image URL:</div>
			<div class="dlg-value"><input value.bind="editImage.src" class="longInput" tabindex="0"></input></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Width:</div>
			<div class="dlg-value"><input value.bind="editImage.width" tabindex="0"/> px</div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Height:</div>
			<div class="dlg-value"><input value.bind="editImage.height" tabindex="0"/> px</div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Alt Text:</div>
			<div class="dlg-value"><input value.bind="editImage.alt" class="longInput" tabindex="0"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Title:</div>
			<div class="dlg-value"><input value.bind="editImage.title" class="longInput" tabindex="0"/></div>
		</div>

		<div class="dlg-property">
			<div class="dlg-label">Alignment:</div>
			<div class="dlg-value"><select value.bind="editImage.align" tabindex="0">
				<option value="None">None</option>
				<option value="Left">Left</option>
				<option value="Right">Right</option>
				<option value="Top">Top</option>
				<option value="Middle">Middle</option>
				<option value="Bottom">Bottom</option>
			</select></div>
		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="editImageModal.close()">Insert</div>
		<div class="button" click.trigger="cancelEditImage()">Cancel</div>
	</div>
  </modal>
  </div>
  	<div class="centerPaneAddons"><!-- Empty --></div>
</div>
  <div class="rightPane">
	<!--<div class="sideProperties"  if.bind="userRole.has('accountRole:_Create')">
		<div class="propertyContextLabel">${g[context]['term:prefLabel'][0].value}</div>
		<div class="property" repeat.for="property of keys(g[context], ['rdf:type','term:prefLabel','term:hasPrimaryImageURL','term:hasDescription','vehicle:hasOptions','term:inGlossary','vehicle:hasVehicleComments', 
		'term:hasIdentifier','term:hasSearchable'])">
		  	<div class="label" title="${property}"             
		  	>${titleCase((g[property]['term:prefLabel'])?g[property]['term:prefLabel'][0].value:property)}:&nbsp;</div>
		  	<div class="valueBlock">
			  	<div class="value" repeat.for="item of wrapArray(g[context][property])">
			  		<span class="link" if.bind="item.type==='uri'" click.trigger="fetchContext(item.value)">${g[item.value]['term:prefLabel'][0].value}<span if.bind="!$last">,&nbsp;</span>
			  		</span>
			  		<span class="value" if.bind="item.type==='literal'" title="${item.datatype}"><span innerhtml="${displayLiteral(item)}"></span> 
			  			<span class="link" click.trigger="fetchContext(item.datatype)" if.bind="g[item.datatype]['term:prefLabel'].length > 0 ">&nbsp;[${g[item.datatype]["term:prefLabel"][0].value}]</span><span if.bind="!$last && $index != 0">, </span>
			  		</span>
			  	</div>
		    </div>
		  </div>
		  <div class="property">
			  <div class="label">Has Curie</div>
	 	      <div click.trigger="fetchContext(context)" class="longWord">${context}</div>
		</div>
	 </div>-->
  </div>
</div>
</div>
  <div class="footer" innerhtml.bind="footer"></div>
</div>
</modal>
<modal view-model.ref="loginModal" closed.delegate="processLogin()">
    <div slot="header">Log In</div>
    <div>
		<div class="dlg-property">
			<div class="dlg-label">Username</div>
			<div class="dlg-value"><input value.bind="loginData.username" type="input"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Password</div>
			<div class="dlg-value"><input value.bind="loginData.password" type="password"/></div>
		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="loginModal.close()">Log in</div>
		<div class="button" click.trigger="loginModal.cancel()">Cancel</div>
	</div>
  </modal>
<!-- <modal view-model.ref="newUserModal" closed.delegate="processNewUserLogin()">
    <div slot="header" class="dlgHeader">
      <div class="dlgHeaderLabel">New ${newLoginData.fullName}</div>
      <div class="button" click.trigger="newLoginModal.cancel()">X</div>
    </div>
    <div>
		<div class="dlg-property">
			<div class="dlg-label">First Name</div>
			<div class="dlg-value"><input value.bind="newLoginData.firstName" type="input"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Last Name</div>
			<div class="dlg-value"><input value.bind="newLoginData.lastName" type="input"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Full Name</div>
			<div class="dlg-value"><input value.bind="newLoginData.fullName" type="input"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Username</div>
			<div class="dlg-value"><input value.bind="newLoginData.username" type="input"/></div>
		</div>
		<div class="dlg-property">
			<div class="dlg-label">Password</div>
			<div class="dlg-value"><input value.bind="newLoginData.password" type="password"/></div>
		</div>
    </div>
	<div class="modal-footer">
		<div class="button" click.trigger="newLoginModal.close()">Log in</div>
		<div class="button" click.trigger="newLoginModal.cancel()">Cancel</div>
	</div>
  </modal>-->



 </div>
</template>



