{"version":3,"sources":["src/resources/index.js","src/modalCustomElement.js","src/main.js","src/environment.js","src/aurelia-cookie.js","src/app.js","src/SortedObjectKeysValueConverter.js","src/ObjectKeysValueConverter.js"],"names":["configure","config","ModalCustomElement","Element","el","visible","attached","open","console","log","close","dispatchEvent","CustomEvent","bubbles","cancel","aurelia","use","standardConfiguration","feature","environment","debug","developmentLogging","testing","plugin","start","then","setRoot","AureliaCookie","get","name","cookies","all","set","value","options","str","encode","expiry","expires","Date","setHours","getHours","path","domain","toUTCString","secure","document","cookie","delete","cookieString","parse","obj","pairs","split","pair","i","length","decode","encodeURIComponent","e","decodeURIComponent","App","window","app","theme","params","getQueryParams","context","qRefine","qr","cache","q","searchData","history","mode","sortMode","sortModeStates","label","namespace","activeLinkPredicate","visibleLinks","cookieLogin","JSON","loginData","username","password","permissions","status","action","userRole","Set","page","pageSize","itemCount","totalPages","wait","templates","server","location","href","match","client","cardEdit","editMode","tempGraph","blocks","loadBlocks","typedMessage","insertTermObj","temp","asImage","image","complianceItem","country","industry","strain","enzyme","product","complianceTest","noItemsMessage","instanceList","constraints","activeConstraint","predicate","object","availableProperties","pageIndex","activeProperty","activePropertyValues","hash","substr","newModal","duplicateModal","addPropertyModal","addConstraintModal","editImageModal","insertTermModal","loginModal","editImage","src","width","height","alt","title","align","globalActions","id","fetchContext","selectedAction","defaultCard","body","curie","prefix","ns","datatype","nodeKind","range","cardinality","sourceCurie","defaultNamespace","activeCard","Object","assign","linkPropertyList","displayFullBody","setTimeout","updateInstanceList","showTypedMessage","alert","invokeAction","find","noPush","cacheState","method","stringify","fetch","blob","json","contextData","g","report","push","ciri","predicates","hasOwnProperty","nodes","map","node","forEach","domainLabel","rangeLabel","links","filter","link","sort","tabIndex","includes","indexOf","activateTab","reversed","refreshBlocks","catch","err","fetchSearch","inputSearch","keys","excludes","excludeSet","keysObj","key","has","expr","local","resetPage","resetMode","regexes","token","RegExp","regex","predicateLinks","qLinks","reverse","Math","ceil","index","prevRefPage","nextRefPage","sortValue","linkNodes","a","item","trim","b","url","queryStr","paramStrs","paramStr","paramTerms","paramName","paramValue","slice","join","displayLiteral","parseFloat","toLocaleString","style","currency","parseInt","maximumFractionDigits","timeZone","replace","lines","entries","line","day","time","launchService","launchSeo","pinPage","refresh","launchPage","goBack","pop","wrapArray","arr","wrappedArray","Array","isArray","type","titleCase","tokens","toUpperCase","tokenize","tokenCase","toLowerCase","jumpTo","setMode","loadIngestData","editCard","saveCard","internalTerms","extractInternalTerms","response","text","filterBody","content","filters","input","boxFilter","listsFilter","parser","DOMParser","parsedHtml","parseFromString","termCuries","from","querySelectorAll","getAttribute","iso2Date","isoDate","date","toLocaleDateString","year","month","deleteItem","splice","editCardProperties","defaultValue","defaultLabel","saveCardProperties","toISOString","termObjs","term","buffer","update","triples","prolog","output","newRecord","subject","revertCard","getLinkOptions","property","values","updateLinkEntry","confirm","encodeURI","revertItem","login","logout","processLogin","newCard","ctx","asProperty","activeCardImage","generateEntityId","duplicateCard","deleteCard","cardType","deleteClassItems","typeLabel","processNewCard","dt","processDuplicateCard","ignorePredicates","triple","startsWith","cleanTitle","summaryFilter","plural","getTerms","results","updateLink","event","srcElement","deleted","tempItem","foundItem","updateClassNamespace","classContext","filterComplianceTest","constraintObj","getDescription","description","getInstanceList","len","addProperty","contextType","activePropertySelected","target","activeClassSelected","processAddProperty","addExistingPropertyValue","newObject","newConstraint","processAddConstraint","constraint","propertyValue","activePropertyValue","objectLabel","removeConstraint","clearConstraints","formatDoc","gui","editor","querySelector","execCommand","focus","createHyperlink","sLnk","prompt","selection","getSelection","toString","setForeColor","evt","setBackColor","setHeading","imageEdit","imageNode","anchorNode","processEditImage","img","html","innerHTML","cancelEditImage","insertTermDlg","insertTerm","cancelInsertTerm","updateInsertTerm","searchItem","s","prefLabel","updateInsertImage","imageURL","insertCodeBlock","hasContent","clearClass","message","setImage","file","files","reader","FileReader","me","addEventListener","result","createImageFile","readAsDataURL","data","imageData","imageType","resp","filepath","selector","container","header","footer","css","template","graph","separator","count","block","targets","contexts","isNullLink","getValidLink","validLink","SortedObjectKeysValueConverter","toView","prop","ObjectKeysValueConverter"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export function configure(config) {\n  //config.globalResources([]);\n}\n","import { inject } from 'aurelia-framework';\r\n\r\n@inject(Element)\r\nexport class ModalCustomElement {\r\n  \r\n  // refs\r\n  el;\r\n\r\n  // view model properties\r\n  visible = false; // This variable will track the visibility state of the modal.\r\n\r\n  constructor(el) {\r\n    this.el = el;\r\n  }\r\n  \r\n  // Whenever a view is loaded with a modal in it, I want to make sure that the\r\n  // modal's visiblility is set back to hidden.\r\n  attached() {\r\n    this.visible = false;\r\n  }\r\n  \r\n  // I create an open() function. By using view-model.ref in my view model, I will \r\n  // be able to call this function to open the modal.\r\n  open() {\r\n    this.visible = true;\r\n    console.log(\"Modal opened\");\r\n  }\r\n  \r\n  // I also create a close() function. This can be called externally, just like\r\n  // open, but is also called internally by the default \"Close\" button in the\r\n  // footer.\r\n  close() {\r\n    \r\n    // The close function will hide the modal...\r\n    this.visible = false;\r\n\r\n    // ...and dispatch an event on the modal that the view model can listen for.\r\n    this.el.dispatchEvent(\r\n      new CustomEvent('closed', { bubbles: true })\r\n    );\r\n  }\r\n  cancel() {\r\n    \r\n    // The close function will hide the modal...\r\n    this.visible = false;\r\n\r\n    // ...but doesn't dispatch the processing event.\r\n/*    this.el.dispatchEvent(\r\n      new CustomEvent('closed', { bubbles: true })\r\n    );*/\r\n  }\r\n}\r\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n//    .plugin('aurelia-cookie');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","var AureliaCookie = (function () {\r\n    function AureliaCookie() {\r\n    }\r\n    /**\r\n    *\r\n    * Get a cookie by its name\r\n    */\r\n    AureliaCookie.get = function (name) {\r\n        var cookies = this.all();\r\n        if (cookies && cookies[name]) {\r\n            return cookies[name];\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n    * Set a cookie\r\n    */\r\n    AureliaCookie.set = function (name, value, options) {\r\n        var str = this.encode(name) + \"=\" + this.encode(value);\r\n        if (value === null) {\r\n            options.expiry = -1;\r\n        }\r\n        /**\r\n        * Expiry date in hours\r\n        */\r\n        if (options.expiry >= 0 && !options.expires) {\r\n            var expires = new Date();\r\n            expires.setHours(expires.getHours() + options.expiry);\r\n            options.expires = expires;\r\n        }\r\n        if (options.path) {\r\n            str += \"; path=\" + options.path;\r\n        }\r\n        if (options.domain) {\r\n            str += \"; domain=\" + options.domain;\r\n        }\r\n        if (options.expires) {\r\n            str += \"; expires=\" + options.expires.toUTCString();\r\n        }\r\n        if (options.secure) {\r\n            str += '; secure';\r\n        }\r\n        document.cookie = str;\r\n    };\r\n    /**\r\n    * Deletes a cookie by setting its expiry date in the past\r\n    */\r\n    AureliaCookie.delete = function (name, domain, path) {\r\n        var cookieString = name + \" =;expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\r\n        if (domain) {\r\n            cookieString += \"; domain=\" + domain;\r\n        }\r\n        if (path) {\r\n            cookieString += \"; path=\" + path;\r\n        }\r\n        document.cookie = cookieString;\r\n    };\r\n    /**\r\n    * Get all set cookies and return an array\r\n    */\r\n    AureliaCookie.all = function () {\r\n        return this.parse(document.cookie);\r\n    };\r\n    AureliaCookie.parse = function (str) {\r\n        var obj = {};\r\n        var pairs = str.split(/ *; */);\r\n        var pair;\r\n        if (pairs[0] === '') {\r\n            return obj;\r\n        }\r\n        for (var i = 0; i < pairs.length; ++i) {\r\n            pair = pairs[i].split('=');\r\n            obj[this.decode(pair[0])] = this.decode(pair[1]);\r\n        }\r\n        return obj;\r\n    };\r\n    AureliaCookie.encode = function (value) {\r\n        try {\r\n            return encodeURIComponent(value);\r\n        }\r\n        catch (e) {\r\n            return null;\r\n        }\r\n    };\r\n    AureliaCookie.decode = function (value) {\r\n        try {\r\n            return decodeURIComponent(value);\r\n        }\r\n        catch (e) {\r\n            return null;\r\n        }\r\n    };\r\n    return AureliaCookie;\r\n}());\r\nexport { AureliaCookie };","import { Router } from 'aurelia-router';\nimport {AureliaCookie} from 'aurelia-cookie';\n\nexport class App {\n  constructor() {\n    //this.userRole = new Set([]);\n    window.app = this;\n    this.theme = \"red\";\n  \tthis.params = this.getQueryParams()||{};\n    this.context = this.params != null?this.params.context||\"page:_Home\":\"page:_Home\";\n    this.qRefine = this.params.qr||\"\";\n    this.cache = this.params.cache||\"cached\";\n    this.q  = this.params.q||\"\";\n    this.searchData = {};\n    this.history = [];\n    this.mode=this.params.mode||\"card\";\n    this.sortMode = \"createdDateDesc\";\n    this.sortModeStates = [\n      {label:\"Created Date Descending\",value:\"createdDateDesc\"},\n      {label:\"Modified Date Descending\",value:\"modifiedDateDesc\"},\n      {label:\"Alphanumeric\",value:\"alpha\"}];\n    this.namespace = '';\n    this.activeLinkPredicate = null;\n    this.visibleLinks = [];\n    let cookieLogin = JSON.parse(AureliaCookie.get(\"login\"));\n    console.log(cookieLogin);\n    this.loginData = cookieLogin?cookieLogin:{username:\"\",password:\"\",permissions:[],status:false,action:\"login\"};\n    this.userRole = new Set(this.loginData.permissions);\n    this.page = 0;\n    this.pageSize = 12;\n    this.itemCount = 0;\n    this.totalPages = 0;\n    this.wait = false;\n    this.templates = {};\n    this.server = (\"\"+document.location.href).match(/\\:\\/\\/localhost/)?\"http://3.84.16.9:8020\":\"\";\n    this.client = (document.location.href).match(/\\:\\/\\/localhost/)?\"\":\"\";\n    this.cardEdit = false;\n    this.editMode = \"edit\";\n    this.tempGraph = null;\n    this.blocks = [];\n    this.loadBlocks();\n    this.typedMessage = '';\n    this.insertTermObj = {label:\"\",value:\"\",temp:\"\",asImage:false,image:\"\"};\n    this.complianceItem={country:\"\", industry:\"\",strain:\"\",enzyme:\"\",product:\"\",complianceTest:\"\",\n      noItemsMessage:`<div><p>No Compliance Tests Exist for this combination.</p><p>While this cannot guarantee that there are no compliance requirements,\n      it does mean that Dupont has not yet developed a compliance test for this contingency, so you should check with regulatory compliance guidelines.</p></div>`};\n    this.instanceList = {};\n    this.instanceList['class:_Class']={};\n    this.instanceList['class:_Class']['rdf:type']=[];\n    this.constraints = [];\n    this.activeConstraint = {predicate:'',object:''}\n    this.availableProperties = [];\n    this.pageIndex =0;\n    this.activeProperty = {};\n    this.activePropertyValues = [];\n    var hash = window.location.hash.substr(1);\n    this.hash = this.mode||hash||\"card\";\n    console.log(this.hash)\n    // refs\n    this.newModal;\n    this.duplicateModal;\n    this.addPropertyModal;\n    this.addConstraintModal;\n    this.editImageModal;\n    this.insertTermModal;\n    this.loginModal \n    this.editImage = {\n      src:\"\",\n      width:\"500px\",\n      height:\"300px\",\n      alt:\"\",\n      title:\"\",\n      align:\"float:left\"\n    }\n    this.globalActions=[\n      {label:\"Select an action\",id:\"selectAction\",action:()=>console.log(\"Select an action\")},\n      {label:\"Go To Classes\",id:\"createNewClass\",action:()=>this.fetchContext(\"class:_Class\",\"list\")},\n      {label:\"Go To Properties\",id:\"createNewProperties\",action:()=>this.fetchContext(\"class:_Property\",\"list\")},\n    ];\n    this.selectedAction=\"selectAction\";\n    this.defaultCard = {title:\"New Card\",body:\"This is a new card.\",image:\"\",curie:\"foo:bar\",prefix:\"\",ns:\"\",datatype:\"\",nodeKind:\"\",\ndomain:\"\",range:\"\",cardinality:\"\",sourceCurie:\"\"};\n    this.defaultNamespace = \"http://semantical.llc/ns/\";\n    this.activeCard = Object.assign(this.defaultCard,{});\n    this.linkPropertyList = {};\n    this.displayFullBody = false;\n//    this.server = \"\";\n//    this.client = this.server\n    setTimeout(()=>{\n        this.fetchContext(this.context,this.mode)\n        this.updateInstanceList('class:_Class');\n        this.updateInstanceList('class:_Property');\n        this.updateInstanceList('class:_Cardinality');\n        this.updateInstanceList('class:_XSD');\n//        this.updateInstanceList('class:_Country');\n//        this.updateInstanceList('class:_Industry');\n//        this.updateInstanceList('class:_Strain');\n//        this.updateInstanceList('class:_ComplianceTest');\n      },50);    \n  }\n\n  showTypedMessage() {\n    alert(this.typedMessage);    \n  }\n\n  invokeAction(){\n    this.globalActions.find((action)=>(action.id === this.selectedAction)).action();\n  }\n\n  fetchContext(context,hash=\"card\",qRefine=\"\",noPush=false,cacheState = \"cached\"){\n    var body = this.constraints;\n  \tvar options = {method: 'POST',\n               body: JSON.stringify(body,null,4),\n               mode: 'cors',\n               cache: 'default'};\n    this.wait = true;\n    //this.cache = cacheState;\n  \twindow.fetch(`${this.server}/lib/server.sjs?context=${context}&cache=${this.cache}`,options)\n  \t.then((blob)=>blob.json())\n  \t.then((json)=>{\n\n        this.selectedAction = \"\";\n  \t\t\tthis.contextData = json;\n  \t\t\tthis.ns = json[\"@context\"];\n  \t\t\tthis.g = json[\"graph\"];\n  \t\t\tthis.report = this.g[\"report:_\"]\n  \t\t\tif (!noPush){this.history.push(this.context);}\n  \t\t\tthis.context = this.report['report:hasContext'][0].value;\n  \t\t\tthis.namespace = this.ciri(context);\n//  \t\t\tthis.predicates = this.report['report:hasPredicate']?this.report['report:hasPredicate'].map((predicate)=>predicate.value):[];\n        this.predicates = [];\n        if (this.report.hasOwnProperty('report:hasPredicateNode')){\n          let nodes = this.report['report:hasPredicateNode'].map((node)=>node.value);\n          nodes.forEach((node)=>{\n            console.log(this.g[node]);\n            let predicate = {\n                curie:this.g[node]['report:hasPredicate'][0].value,\n                label:this.g[node]['report:hasPredicateLabel'][0].value,\n                domain:this.g[node].hasOwnProperty('report:hasPredicateDomain')?this.g[node]['report:hasPredicateDomain'][0].value:\"class:_Term\",\n                domainLabel:this.g[node].hasOwnProperty('report:hasPredicateDomainLabel')?this.g[node]['report:hasPredicateDomainLabel'][0].value:\"Term\",\n                range:this.g[node].hasOwnProperty('report:hasPredicateRange')?this.g[node]['report:hasPredicateRange'][0].value:\"class:_Term\",\n                rangeLabel:this.g[node].hasOwnProperty('report:hasPredicateRangeLabel')?this.g[node]['report:hasPredicateRangeLabel'][0].value:\"Term\",\n              }\n              this.predicates.push(predicate);\n          })\n        }\n  \t\t\tthis.links = this.report['report:hasLink']?this.report['report:hasLink'].filter((link)=>link.value != null).map((link)=>link.value):[];\n        this.page = 0;\n  \t\t\tthis.sort();\n        let tabIndex = this.predicates.map((predicate)=>predicate.curie).includes('rdf:type')?this.predicates.map((predicate)=>predicate.curie).indexOf('rdf:type'):0;\n  \t\t\tthis.activateTab(this.predicates.map((predicate)=>predicate.curie)[tabIndex],true,true);\n  \t\t\tthis.qRefine = qRefine;\n  \t\t\tthis.q = \"\";\n        this.reversed = false;\n        this.wait = false;\n        this.mode = hash;\n        this.refreshBlocks();\n  \t\t\t//console.log(this.activeLinkPredicate);\n        //console.log(\"************ Predicates\");\n        //console.log(this.predicates)\n  \t\t\t//console.log(json)\n  \t\t})\n  \t.catch((err)=>{\n      console.log(\"Error\");\n      if (!this.g.hasOwnProperty('report:_')){\n        this.fetchContext('page:_404_TermNotFound','card');\n      }\n      else {\n        console.log(err);\n        this.wait = false;\n      }})\n    \n  }\n\n\n\n  fetchSearch(){\n  \tif (this.q != \"\"){\n  \tvar options = {method: 'GET',\n               mode: 'cors',\n               cache: 'default'};\n  \twindow.fetch(`${this.server}/lib/search.sjs?q=${this.q}`,options)\n  \t.then((blob)=>blob.json())\n  \t.then((json)=>{\n        this.mode = 'search';\n        this.searchData = json;\n\n  \t\t\t//console.log(\"startSearch\");\n/*  \t\t\tthis.contextData = json;\n  \t\t\tthis.ns = json[\"@context\"];\n  \t\t\tthis.g = json[\"graph\"];\n  \t\t\tthis.report = this.g[\"report:_\"];\n  \t\t\tthis.history.push(this.context);\n  \t\t\tthis.context = this.report['report:hasContext'][0].value;\n\n  \t\t\tthis.namespace = this.ciri(this.context);\n  \t\t\tthis.predicates = this.report['report:hasPredicate']?this.report['report:hasPredicate'].map((predicate)=>predicate.value):[];\n  \t\t\tthis.links = this.report['report:hasLink']?this.report['report:hasLink'].map((link)=>link.value):[];\n  \t\t\tthis.sort();\n  \t\t\tthis.activateTab(this.predicates[0]);\n  \t\t\tthis.qRefine = \"\";\n  \t\t\t//console.log(this.activeLinkPredicate);\n  \t\t\t//console.log(json)\n  \t\t\t//console.log(\"endSearch\");\n        */\n  \t\t})\n  \t.catch((err)=>console.log(err))\n  \t}\n  }\n\ninputSearch(){\n    if (this.q != \"\"){\n    var options = {method: 'GET',\n               mode: 'cors',\n               cache: 'default'};\n    window.fetch(`${this.server}/lib/search.sjs?q=${this.q}`,options)\n    .then((blob)=>blob.json())\n    .then((json)=>{\n        this.searchData = json;\n        console.log(this.searchData)\n      })\n    .catch((err)=>console.log(err))\n    }\n  }\n\n\n  keys(obj,excludes=[]){\n  \tconsole.log(\"***** Keys\");\n  \tlet excludeSet = new Set(excludes);\n  \tlet keysObj = [];\n  \tfor(var key in obj){\n  \t\t//console.log(obj);\n  \t\t//console.log(key);\n  \t\tif (!excludeSet.has(key)){keysObj.push(key)}\n  \t\t}\n  \t//console.log(keysObj);\t\n  \treturn keysObj.sort();\n  }\n  ciri(expr){\n  \tlet [prefix,local] = expr.split(\":\");\n  \t//console.log(prefix,local);\n  \t//console.log(this.contextData['@context'])\n  \treturn `${this.contextData['@context'][prefix]}${local}`;\n  }\n  activateTab(predicate,resetPage = true,resetMode = false){\n  \t//console.log(this.qRefine);\n  \tthis.activeLinkPredicate = predicate;\n    console.log(this.activeLinkPredicate);\n  \tvar regexes = this.qRefine.split(/\\s+/).map((token)=>(token != '')?new RegExp(token,'i'):null).filter((regex)=>regex != null);\n  \t//console.log(regex);\n  \t/*this.links.forEach((link)=>{\n  \t\tthis.g[link].visible = this.g[link].hasOwnProperty(this.activeLinkPredicate) && (this.g[link][this.activeLinkPredicate][0].value === this.context);\n  \t\tthis.g[link].visible = this.g[link].visible && (regex?(this.g[link]['term:prefLabel'][0].value).match(regex):true);\n  \t\t\n  \t\t})*/\n    var predicateLinks = this.links.filter((link)=>this.g[link].hasOwnProperty(this.activeLinkPredicate) && (this.g[link][this.activeLinkPredicate][0].value === this.context));\n    var qLinks = predicateLinks;\n//    var searchables = new Set(['dealer:Class','vehicle:Class']);\n    for (var regex of regexes){\n//      if (searchables.has(this.g[this.context]['rdf:type'][0].value)){\n//          console.log(regex);\n//          console.log(qLinks);\n//          qLinks = qLinks.filter((link)=> regex?((this.g[link]['term:prefLabel'][0].value).match(regex))||(this.g[link]['term:hasSearchable'][0].value).match(regex):true);\n//        } else {\n          qLinks = qLinks.filter((link)=> regex?(this.g[link]['term:prefLabel'][0].value).match(regex):true);\n//        }\n    }\n    this.itemCount = qLinks.length;\n    if (this.reversed){qLinks.reverse()}\n    this.totalPages = Math.ceil((this.itemCount - 1)/ this.pageSize);\n    this.visibleLinks =qLinks.filter((link,index)=>index >= (this.pageSize * this.page) && (index <this.pageSize * (this.page + 1)))\n    //this.visibleLinks = this.filterVisible();\n    if (resetPage){\n      this.page = 0;\n    }\n    if (resetMode){\n      this.mode = \"card\"\n    }\n  \t}\n    prevRefPage(){\n      if (this.page > this.totalPages){\n        this.page = this.totalPages - 1;\n      }\n      else {\n        this.page = this.page>0?this.page - 1:0;\n        }\n      this.activateTab(this.activeLinkPredicate,false);\n    }\n    nextRefPage(){\n      if (this.page > this.totalPages){\n          this.page = this.totalPages - 1}\n      else {\n        this.page = this.page<this.totalPages - 1?this.page + 1:this.totalPages -1;\n      }\n      this.activateTab(this.activeLinkPredicate,false);\n    }\n  \tsort(){\n      console.log(this.sortMode);\n      let sortValue;\n  \t\t//console.log(\"Links\");\n  \t\t//console.log(this.links);\n  \t\tthis.links.forEach((link)=>{\n  \t\t\t//console.log(this.g[link]);\n  \t\t\tthis.g[link].link = link;\n  \t\t});\n  \t\tvar linkNodes = this.links.map((link)=>{\n  \t\t\t//console.log(\"Link\");\n  \t\t\t//console.log(link);\n  \t\t\treturn this.g[link]\n  \t\t});\n  \t\t//console.log(this.links);\n  \t\t//console.log(\"entering sort\");\n  \t\tif (linkNodes.length>1){\n        if (this.sortMode === \"alpha\"){\n            sortValue = (a) => {\n              let item = a[\"term:prefLabel\"][0].value.trim();\n              return item;\n            }\n            linkNodes.sort((a,b)=>sortValue(a) <= sortValue(b)?-1:1)\n        }\n        if (this.sortMode === \"createdDateDesc\"){\n            sortValue = (a)=> a.hasOwnProperty('term:hasCreatedDate')?`${a[\"term:hasCreatedDate\"][0].value}`:\"\";\n            linkNodes.sort((a,b)=> sortValue(a) <= sortValue(b)?1:-1)\n        }\n        if (this.sortMode === \"modifiedDateDesc\"){\n            sortValue = (a)=> a.hasOwnProperty('term:hasLastModifiedDate')?`${a[\"term:hasLastModifiedDate\"][0].value}`:\"\";\n            linkNodes.sort((a,b)=> sortValue(a) <= sortValue(b)?1:-1)\n\n        }\n\t  \t}\n\t  \t//console.log(\"Link Nodes\");\n  \t\t//console.log(linkNodes);\n  \t\tthis.links=linkNodes.map((node)=>node.link);\n      this.activateTab(this.activeLinkPredicate);\n  \t}\n\n\n\n  \tgetQueryParams(){\n  \t\tvar url = window.document.location.href;\n  \t\tvar queryStr = url.split(\"?\")[1];\n  \t\tvar params = {};\n  \t\tif (queryStr != null){\n  \t\t\tvar paramStrs = queryStr.split(\"&\");\n  \t\t\tparamStrs.forEach((paramStr)=>{\n  \t\t\t\tvar paramTerms = paramStr.split(\"=\");\n  \t\t\t\tvar paramName = paramTerms[0];\n  \t\t\t\tvar paramValue = paramTerms.slice(1).join(\"=\");\n  \t\t\t\tparams[paramName] = paramValue;\n  \t\t\t})\n  \t    return params;\n  \t\t}\n  \t}\n  \tdisplayLiteral(item){\n      if (!item){return \"\"}\n      let datatype = item.datatype||\"xsd:string\";\n      switch(datatype){\n        case 'xsd:currency_usd':{return parseFloat(item.value).toLocaleString([\"en-us\"],{style:\"currency\",currency:\"USD\"})};\n        case 'xsd:integer':{return parseInt(item.value).toLocaleString([\"en-us\"],{style:\"decimal\",maximumFractionDigits:0})};\n        case 'xsd:float':{return parseFloat(item.value).toLocaleString([\"en-us\"],{style:\"decimal\",maximumFractionDigits:4})};\n        case 'unit:_MilesPerGallon':{return `${parseInt(item.value)} mpg`};\n        case 'unit:_Mile':{return `${parseInt(item.value).toLocaleString([\"en-us\"],{style:\"decimal\",maximumFractionDigits:1})} miles`};\n        case \"xsd:dateTime\":{return `${(new Date(item.value)).toLocaleString([\"en-us\"],{ timeZone: 'UTC' } )}`};\n        case \"termType:_Image\":return `<a href=\"${item.value}\" target=\"_blank\"><img src=\"${item.value}\" class=\"imageThumbnail\"/></a>`;\n        case \"xsd:textLiteral\":return item.value;\n        case \"xsd:imageURL\":return `<div class=\"internalImageContainer\"><a href=\"${item.value}\" target=\"_blank\"><img src=\"${item.value}\" class=\"link internalImage\"/></a></div`;\n        case \"xsd:hexColor\":return `<div class=\"colorSwatchContainer\">\n          <div class=\"colorSwatch\" style=\"background-color:${item.value}\">&nbsp;</div>\n          <div class=\"colorValue\">${item.value}</div>\n          </div>`;\n        case \"xsd:anyURI\":return `<a href=\"${item.value}\" target=\"_blank\" class=\"link\">${item.value.replace(/(http.+?\\/\\/)(.+?\\/).*/,'$1$2...')}</a>`;\n        case \"xsd:anyURL\":return `<a href=\"https://${item.value}\" target=\"_blank\" class=\"link\">${item.value.replace(/(http.+?\\/\\/)(.+?\\/).*/,'$1$2...')}</a>`;\n        case \"identifier:_Email\":return `<a href=\"mailto:${item.value}\" target=\"_blank\" class=\"emailLink\"><span>${item.value}</span></a>`\n        case \"xsd:hours\":{\n          let lines = item.value.split('|');\n          let entries = lines.map((line)=>{\n            if (line != ''){\n              let [day,time] = line.replace(/(.+?)\\:(.+?)/,\"$1#$2\").split(\"#\");\n              day = day.trim();\n              time = time.trim();\n              return `<div class=\"item\"><div class=\"label\">${day}</div><div class=\"value\">${time}</div></div>`\n            }\n            else {return ''}\n          })\n          return `<div class=\"hours\">${entries.join('')}</div>`\n        };\n  \t\t  default: {return `${item.value}`};\n      }\n\n  \t}\n  \tlaunchService(){\n  \t\twindow.open(`${this.server}/lib/server.sjs?context=${this.context}`,'')\n  \t}\n    launchSeo(){\n      window.open(`${this.server}/lib/seo.sjs?context=${this.context}`,'')\n    }\n  \tpinPage(refresh=true,mode=\"card\"){\n      //console.log(this.context);\n  \t\twindow.location.href = `${this.client}/?context=${this.context}${refresh?`&cache=refresh&mode=${this.mode}`:''}`;\n  \t}\n\n  \tlaunchPage(context=this.context,mode=this.mode){\n  \t\twindow.open(`${this.client}/?context=${context}&cache=refresh&mode=${mode}`)\n  \t}\n\n  \tgoBack(){\n  \t\tif (this.history.length > 1){\n  \t\t\t//this.history.pop();\n  \t\t\tvar context = this.history.pop();\n  \t\t\tthis.fetchContext(context,\"card\",\"\",true);\n  \t\t}\n  \t}\n  \twrapArray(arr){\n  \t\tlet wrappedArray = Array.isArray(arr)?arr:(arr!=null)?[arr]:[];\n      if (wrappedArray.length > 0){\n        if (wrappedArray[0].type === 'uri'){\n          wrappedArray.sort((a,b)=>a.value > b.value?1:a.value < b.value?-1:0)\n//          wrappedArray.sort((a,b)=>this.g[a.value]['term:prefLabel'][0].value > this.g[b.value]['term:prefLabel'][0].value?1:this.g[a.value]['term:prefLabel'][0].value < this.g[b.value]['term:prefLabel'][0].value?-1:0)\n        }}\n      return wrappedArray;\n  \t}\n    titleCase(str){\n      var tokens = str.split(/\\s+/);\n      return tokens.map((token)=>`${token.substr(0,1).toUpperCase()}${token.substr(1)}`).join(' ');\n    }\n\n    tokenize(str,tokenCase = \"title\"){\n      var tokens = str.split(/\\s+/);\n      let expr = tokens.map((token)=>`${token.substr(0,1).toUpperCase()}${token.substr(1)}`).join('');\n      expr = expr.replace(/[^A-z0-9_\\-]/gi,'');\n      if (tokenCase === \"camel\"){\n        return `${expr.substr(0,1).toLowerCase()}${expr.substr(1)}`;\n        }\n      else {\n        return expr;        \n      }\n    }\n\n    reverse(){\n      this.reversed = ! this.reversed;\n      this.page =0;\n      this.activateTab(this.activeLinkPredicate);\n    }\n\n    jumpTo(selectedAction){\n        this.qRefine = \"\";\n        this.constraints = [];        \n        this.fetchContext(selectedAction,'list')\n    }\n\n    setMode(mode){\n      if (this.cardEdit){\n         alert(\"You must save or revert changes before changing mode.\")\n      }\n      else {\n        this.mode=mode;\n        this.hash=this.mode;\n        switch(mode){\n          case \"ingestion\":this.loadIngestData();break;\n          case \"list\":{\n            this.qRefine = \"\";\n            this.constraints = [];\n            if (this.predicates.map((predicate)=>predicate.curie).includes('rdf:type')){\n              console.log(this.predicates);\n              this.activateTab('rdf:type')\n            }\n            break;\n          }\n          default:break\n        }\n      }\n    }\n    loadIngestData(){\n //     console.log(\"Ingest data loaded.\")\n        fetch(`${this.server}/files/analysis.json`)\n        .then((blob)=>blob.json())\n        .then((json)=>{\n          this.templates = json;\n\n        })\n    }\n    editCard(editMode=\"edit\"){\n       if (editMode === \"edit\"){\n         this.activeCard.title = this.g[this.context]['term:prefLabel'][0].value\n       }\n       else {\n         this.activeCard.title = this.g[this.context]['term:prefLabel'][0].value + \" Copy\";\n         this.activeCard.sourceCurie = this.context;\n       }\n       this.activeCard.body = this.g[this.context]['term:hasDescription']!=null?this.g[this.context]['term:hasDescription'][0].value:\"\";\n       console.log(this.g[this.context].hasOwnProperty('term:hasPrimaryImageURL'));\n       this.activeCard.image = this.g[this.context]['term:hasPrimaryImageURL']!=null?this.g[this.context]['term:hasPrimaryImageURL'][0].value:\"\";\n       this.activeCard.context = this.context;\n       this.activeCard.curie = this.context;\n       this.cardEdit = true;\n       this.editMode = editMode;\n    }\n    saveCard(){\n//       this.g[this.context]['term:prefLabel'][0].value = this.activeCard.title;\n//       this.g[this.context]['term:hasDescription']=[{datatype:\"termType:_HTML\",value:this.activeCard.body,type:\"literal\"}];\n//       this.g[this.context]['term:hasPrimaryImageURL'] = [{datatype:\"termType:_Image\",value:this.activeCard.image,type:\"literal\"}];\n       //this.activeCard.curie = this.context;\n       this.activeCard.context = this.activeCard.curie;\n       let internalTerms = this.extractInternalTerms(this.activeCard.body);\n       let path = `${this.server}/lib/saveCard.sjs`;  \n       console.log(path);\n/*       let options = {\n        headers: {'Content-Type': 'application/json'},\n        body:JSON.stringify(this.activeCard),\n        method:\"post\"};*/\n//        path += `?json=${JSON.stringify(this.activeCard).replace(/\\#/g,\"%%%\")}`;\n        console.log(this.activeCard);\n        window.fetch(path,{body:JSON.stringify(this.activeCard),method:\"POST\"})\n       .then((response)=>response.text())\n       .then((text)=>{\n//          this.pinPage(true,\"card\");\n          this.cache = \"refresh\";\n          this.fetchContext(this.activeCard.curie,\"card\")\n//            console.log(text);\n        })\n       .catch((e)=>console.log(e));\n       this.cardEdit = false;\n    }\n    filterBody(content,filters=['box']){\n      let input = content||\"\";\n      if (input === \"\"){return \"\"}\n      //console.log(`content = ${input}`);\n      filters.forEach((filter)=>{\n      switch(filter){\n        case \"box\": input = this.boxFilter(input);return input;break;\n        case \"lists\": input = this.listsFilter(input);return input;break;\n        default: input;\n      }\n    })\n    return input\n  }\n  extractInternalTerms(body){\n    let parser = new DOMParser();\n    let parsedHtml = parser.parseFromString(body, 'text/html');\n    let termCuries = Array.from(parsedHtml.querySelectorAll(\"a\")).filter((node)=>node.getAttribute('property')==='term:hasInternalTerm').map((node)=>node.getAttribute('resource'));\n    return termCuries\n  }\n  \n  boxFilter(input){\n    input = input.replace(/\\[(.*?)\\|(.*?)\\]/g,`<a href=\"?context=$1\">$2</a>`);\n    input = input.replace(/\\*/g,`<li>`); // Replaces *s with list items. Doesn't handle inline * case well\n    return input;\n  }\n  iso2Date(isoDate){\n    let date = new Date(isoDate);\n    return date.toLocaleDateString(\"en-us\",{ year: 'numeric', month: '2-digit', day: '2-digit' });\n  }\n  deleteItem(index,arr){\n    arr.splice(index,1)\n  }\n  editCardProperties(){\n    console.log(this.g[this.context]);\n    this.cardEdit=true;\n    this.activeCard.title = this.g[this.context]['term:prefLabel'][0].value;\n    this.activeCard.body = this.g[this.context]['term:hasDescription'][0].value;\n\n    this.activeCard.image = this.g[this.context]['term:hasPrimaryImageURL'][0].value;\n    this.activeCard.context = this.context;\n    this.activeCard.curie = this.context;\n    Object.keys(this.g[this.context]).forEach((predicate)=>{\n      if (!Array.isArray(this.g[this.context][predicate])){this.g[this.context][predicate]=[]};\n      this.g[this.context][predicate].forEach((object)=>{\n        if (object.type === \"uri\"){\n          console.log(object.value,this.g.hasOwnProperty(object.value));\n          if (this.g.hasOwnProperty(object.value)){\n            if (this.g[object.value]!=null){\n              object.label = this.g[object.value]['term:prefLabel'][0].value;\n              object.defaultValue = object.value;\n              object.defaultLabel = object.label;\n            }\n          }\n        }\n      })\n    })\n  }\n  saveCardProperties(){\n    this.cardEdit = false;\n    let context = this.context;\n    let curie = this.activeCard.curie;\n       this.g[this.context]['term:prefLabel'][0].value = this.activeCard.title!= ''?this.activeCard.title:`${this.tokenize((new Date()).toISOString())}`;\n       this.g[this.context]['term:hasDescription']=[{datatype:\"xsd:html\",value:this.activeCard.body,type:\"literal\"}];\n       this.g[this.context]['term:hasPrimaryImageURL'] = [{datatype:\"xsd:imageURL\",value:this.activeCard.image,type:\"literal\"}];\n       if (this.activeCard.sourceCurie != ''){\n         this.g[this.context]['term:hasSourceTerm'] = [{value:this.activeCard.sourceCurie,type:\"uri\"}];\n       }\n    let internalTerms = this.extractInternalTerms(this.activeCard.body);  \n    let termObjs=internalTerms.map((term)=>{return {value:term,type:\"uri\"}}); \n    console.log(termObjs);\n    this.g[this.context]['term:hasCrossReference']=termObjs\n    let buffer = [];\n    let update = Object.keys(this.g[context]).forEach((predicate)=>{\n      this.g[context][predicate].forEach((object)=>{\n        if (object.type==='uri'){\n          buffer.push(`${curie} ${predicate} ${object.value}.`)\n        }\n        else {\n          buffer.push(`${curie} ${predicate} \"\"\"${object.value}\"\"\"^^${object.datatype||'xsd:string'}.`)\n        }\n      })\n    })\n    let triples = buffer.join('\\n');\n    let prolog = Object.keys(this.ns).map((prefix)=>`prefix ${prefix}: <${this.ns[prefix]}>`).join('\\n');\n    let output = `${prolog}\ndelete {${context} ?p ?o}\ninsert {\n  ${triples}\n}\nwhere {\n  ${context} ?p ?o\n}`;\n  let newRecord = {\"@context\":this.namespace,\"graph\":this.g,subject:context,curie:curie};\n  let path = `${this.server}/lib/updateProperties.sjs`;\n  window.fetch(path,{method:\"POST\",body:JSON.stringify(newRecord,null,4)})\n       .then((response)=>response.text())\n       .then((text)=>{\n          this.pageIndex = this.pageIndex+1;\n          //location.href=`/?context=${context}&index=${this.pageIndex}#properties`;\n//          this.pinPage(true,\"properties\");\n//          this.cache=\"refresh\";\n          this.fetchContext(curie,this.mode||\"card\");\n          //console.log(text);\n        })\n       .catch((e)=>console.log(e));\n  }\n\n  revertCard(){\n      this.pinPage(true,\"card\");\n      console.log(\"revertCard() called\");\n  }\n\n  getLinkOptions(property){\n    if (this.linkPropertyList.hasOwnProperty(property)){\n        return this.linkPropertyList[property].values||[];\n      }\n    else {\n        return []\n    }\n  }\n  updateLinkEntry(item,property){\n    if (this.linkPropertyList.hasOwnProperty(property)){\n      let link = this.linkPropertyList[property].values.find((link)=>link.value === item.label);\n      if (link){\n        item.value = link.context;\n      }\n      else {\n        let action = confirm(\"Do you wish this to be a new Entry?\");\n        if (action){\n          item.value = item.value.replace(/^(\\w+):(\\w+)/,`$1:_${this.tokenize(item.label)}`);\n          let prolog = Object.keys(this.ns).map((prefix)=>`prefix ${prefix}: <${this.ns[prefix]}>`).join('\\n');\n          let update = `${prolog}\n  insert data {\n    ${item.value}\n        a ${this.linkPropertyList[property].type};\n        term:prefLabel \"${item.label}\"^^xsd:string;\n        .\n  }`;\n        console.log(update);\n        console.log(\"ToDo: Complete the update of the new entry.\")\n        let path = `${this.server}/lib/updateProperties.sjs?update=${encodeURI(update.replace(/(#)/g,\"%%%\"))}`;\n        window.fetch(path)\n             .then((response)=>response.text())\n             .then((text)=>{\n                this.pinPage(true);\n                console.log(text);\n              })\n             .catch((e)=>console.log(e));\n        }\n        else {\n          this.revertItem(item);\n        }\n      }\n    }\n  }\n  revertItem(item){\n    item.value = item.defaultValue;\n    item.label = item.defaultLabel;\n  }\n\n  login(){\n    this.loginData.action=\"login\";\n    this.loginModal.open();\n  }\n\n  logout(){\n    this.loginData.password = \"\";\n    this.loginData.status = false;\n    this.loginData.action = \"logout\";\n    let path = `${this.server}/lib/access.sjs`;\n    let params = {method:\"POST\",body:JSON.stringify(this.loginData)};\n    //console.log(params);\n    window.fetch(path,params)\n      .then((response)=>response.json())\n      .then((json)=>{\n        console.log(json);\n          this.loginData  = json;\n          this.userRole = new Set(this.loginData.permissions);\n          AureliaCookie.delete(\"login\");\n          this.cache = \"cached\";\n      })\n      .catch((e)=>console.log(e));\n  }\n\n\n  processLogin(){\n    let path = `${this.server}/lib/access.sjs`;\n    let params = {method:\"POST\",body:JSON.stringify(this.loginData)};\n    //console.log(params);\n    window.fetch(path,params)\n      .then((response)=>response.json())\n      .then((json)=>{\n        console.log(json);\n          this.loginData  = json;\n          this.userRole = new Set(this.loginData.permissions);\n          if (!this.loginData.status){alert(\"Log-in failed.\")}\n          else {\n            AureliaCookie.set(\"login\",JSON.stringify(this.loginData),{expiry:24,path:'',domain:'',secure:false})\n          }\n      })\n      .catch((e)=>console.log(e));\n  }\n\n\n  newCard(ctx,asProperty=false){\n    let context = ctx||this.context;\n    this.context = context;\n    this.activeCard = Object.assign(this.defaultCard,{});\n    this.activeCard.type = context;\n    this.activeCard.title = \"\";\n    this.activeCard.body = \"\";\n//    this.activeCard.domain = context;\n    this.activeCard.image = this.g.hasOwnProperty(context)?Array.isArray(this.g[context]['term:hasPrimaryImageURL'])?this.g[context]['term:hasPrimaryImageURL'][0].value:\"\":\"\";\n    this.activeCard.image = this.activeCardImage||\"\";\n    if (context === 'class:_Property'){\n      this.activeCard.nodeKind = '';\n      this.activeCard.range = '';\n      this.activeCard.datatype = '';\n      this.activeCard.cardinality = '';\n    }\n    else if (asProperty === true){\n      this.context = \"class:_Property\";\n      this.activeCard.domain = context;\n      this.activeCard.type = \"class:_Property\";\n      this.activeCard.nodeKind = 'nodeKind:_IRI';\n      this.activeCard.range = '';\n      this.activeCard.datatype = '';\n      this.activeCard.cardinality = 'cardinality:_ZeroOrMore';\n \n    }\n    this.generateEntityId(this.context);\n    this.newModal.open();\n  }\n\n  duplicateCard(){\n    this.revertCard = Object.assign(this.activeCard,{});\n    this.activeCard = {\n      title:`${this.g[this.context]['term:prefLabel'][0].value} Copy`,\n      body:this.g[this.context].hasOwnProperty('term:hasDescription')?this.g[this.context]['term:hasDescription'][0].value:' ',\n      image:this.g[this.context].hasOwnProperty('term:hasPrimaryImageURL')&&Array.isArray(this.g[this.context]['term:hasPrimaryImageURL'])?this.g[this.context]['term:hasPrimaryImageURL'][0].value:' ',\n      curie:`${this.context}_Copy`,\n      sourceCurie:this.context\n    };\n    this.duplicateModal.open();\n  }\n  deleteCard(){\n    let cardType = this.g[this.context]['rdf:type'][0].value;\n    if (cardType === \"class:_Class\"){\n      this.deleteClassItems()\n    }\n    else {\n    let typeLabel = this.g[cardType]['term:prefLabel'][0].value;\n     if (confirm(`Are you sure you wish to delete this ${typeLabel.toLowerCase()}?`)){\n          //console.log(`Delete card ${cardType}`);\n          let path = `${this.server}/lib/deleteCard.sjs?context=${this.context}`;\n          window.fetch(path)\n            .then((response)=>response.text())\n            .then((text)=>{\n              console.log(text);\n              //location.href =  `${this.client}?context=${cardType}&mode=list&cache=replace`\n              this.fetchContext(cardType,\"list\")\n            })\n            .catch((err)=>console.log(err));\n     }  \n   }\n  }\n  processNewCard(){\n    console.log(\"processing card\");\n    if (this.activeCard.title === \"\"){\n        let dt = new Date();\n        this.activeCard.title = `${dt}`;\n        this.activeCard.curie += this.tokenize(dt.toISOString());\n      }\n\n    let prolog = Object.keys(this.ns).map((prefix)=>`prefix ${prefix}: <${this.ns[prefix]}>`).join('\\n');\n        console.log(\"ToDo: Complete the update of the new entry.\");\n\n        if (this.activeCard.prefix != ''){\n           this.ns[this.activeCard.prefix] = this.activeCard.namespace;\n           let path = `${this.server}/lib/updateNamespaces.sjs?prefix=${this.activeCard.prefix}&namespace=${this.activeCard.namespace}&action=add`;\n           window.fetch(path)\n             .then((response)=>response.text())\n             .then((text)=>{\n                console.log(text);\n              })\n             .catch((e)=>console.log(e));\n          }\n        console.log(this.activeCard);\n        let path = `${this.server}/lib/newCard.sjs`;\n        window.fetch(path,{method:\"POST\",body:JSON.stringify(this.activeCard,null,4)})\n             .then((response)=>response.text())\n             .then((text)=>{\n                console.log(this.activeCard);\n                location.href =  `${this.client}?context=${this.activeCard.curie}&cache=refresh&mode=card`\n                //console.log(text);\n              })\n             .catch((e)=>console.log(e));\n  }\n\n  processDuplicateCard(){\n    console.log(\"processing duplicate card\");\n    let ignorePredicates = new Set(['term:prefLabel','term:hasDescription','term:hasPrimaryImageURL','rdf:type']);\n    let prolog = Object.keys(this.ns).map((prefix)=>`prefix ${prefix}: <${this.ns[prefix]}>`).join('\\n');\n    console.log(this.context,this.g[this.context]);\n    let triples = [];\n    var triple;\n    Object.keys(this.g[this.context]).forEach((predicate)=>{\n        if (!ignorePredicates.has(predicate)){\n        this.g[this.context][predicate].forEach((object)=>{\n          if (object.type === 'literal'){\n            triple = `${this.activeCard.curie} ${predicate} ${object.value}.`;\n          }\n          else {\n            triple = `${this.activeCard.curie} ${predicate} \"\"\"${object.value}\"\"\"^^${object.datatype||'xsd:string'}.`;            \n          }\n          triples.push(triple);\n        })\n        }})\n    let update = `${prolog}\n  insert data {\n    ${this.activeCard.curie}\n        a ${this.g[this.context]['rdf:type'][0].value};\n        term:prefLabel \"\"\"${this.activeCard.title}\"\"\"^^xsd:string;\n        term:hasDescription \"\"\"${this.activeCard.body}\"\"\"^^termType:_HTML;\n        term:hasPrimaryImageURL \"${this.activeCard.image}\"^^termType:_Image;\n        term:isDerivedFrom ${this.activeCard.sourceCurie};\n        .\n    ${triples.join('\\n')}\n}`;\n        console.log(update);\n        let path = `${this.server}/lib/updateProperties.sjs?update=${encodeURI(update.replace(/(#)/g,\"%%%\"))}`;\n        window.fetch(path)\n             .then((response)=>response.text())\n             .then((text)=>{\n//                location.href =  `${this.client}?context=${this.activeCard.curie}&cache=refresh`\n                console.log(text);\n              })\n             .catch((e)=>console.log(e));\n  }\n\n\n  generateEntityId(context){\n    console.log(`Generate Entity Id - ${context}`)\n    if  (context.startsWith('class:')){\n      let  prefix = this.tokenize(context.replace(/.*\\:_(.+?)$/,\"$1\"),\"camel\");\n      if (context === 'class:_Class'){\n        let cleanTitle = this.summaryFilter(this.activeCard.title,128)\n        var id = this.tokenize(cleanTitle);\n        this.activeCard.curie =  `class:_${id}`;\n        var prefix = this.tokenize(cleanTitle,\"camel\");\n        this.activeCard.prefix = prefix;\n        this.activeCard.namespace = `${this.defaultNamespace}${prefix}/`;\n        this.activeCard.plural = `${this.activeCard.title}s`;\n      }\n      else if (context === 'class:_Property'){\n        let cleanTitle = this.summaryFilter(this.activeCard.title,128)\n        var id = this.tokenize(cleanTitle,\"camel\");\n        var domain = this.tokenize(this.activeCard.domain.replace(/.+?\\:_/,''),'camel');\n\n        var prefix = domain;\n        this.activeCard.curie =  `${prefix}:${id}`;\n        \n      }      \n      else {\n        let cleanTitle = this.summaryFilter(this.activeCard.title,128)\n        var id = this.tokenize(cleanTitle);\n        if (id === \"\"){id = this.tokenize((new Date()).toISOString())}\n        this.activeCard.curie = `${prefix}:_${id}`;\n        this.activeCard.prefix = \"\";\n        this.activeCard.namespace = \"\";\n      }\n    }\n    else {\n      let cleanTitle = this.summaryFilter(this.activeCard.title,128)\n      let  prefix = context.replace(/(.*)\\:_.+?$/,\"$1\");\n      var id = this.tokenize(cleanTitle);\n      if (id === \"\"){id = this.tokenize((new Date()).toISOString())}\n      this.activeCard.curie = `${prefix}:_${id}`;\n      this.activeCard.title = cleanTitle;\n    }\n  }\n\n\n  getTerms(property){\n    //console.log(property);\n    let path = `${this.server}/lib/terms.sjs?predicate=${property}`;\n    window.fetch(path)\n       .then((response)=>response.json())\n       .then((json)=>{\n//          console.log(json.results);\n          this.linkPropertyList = {};\n          this.linkPropertyList[property] = json.results;\n          //console.log(this.linkPropertyList[property]);\n       });\n    return [];\n  }\n  updateLink(context,property,item,event){\n    console.log(\"*** updateLink\");\n    //console.log(item.value,event.srcElement.value);\n    let value = event.srcElement.value;\n    console.log(value);\n    if (value === \"delete\"){\n//       delete this.g[context][property].find((tempItem)=>tempItem.value === item.value);\n//       delete this.linkPropertyList[property].find((tempItem)=>event.srcElement.value === tempItem.context);\n//       delete event.srcElement;\n         item.deleted=true;\n      console.log(\"deletes called\");\n    }\n    else {\n        let label = this.linkPropertyList[property].find((tempItem)=>event.srcElement.value === tempItem.context).value;\n        console.log(label);\n        let foundItem = this.g[context][property].find((tempItem)=>tempItem.value === item.value);\n        foundItem.value = value;\n        foundItem.label = label;\n        console.log(foundItem);\n        }\n    //item.value = event.srcElement.value;\n//    item.label = event.srcElement.label;\n\n  }\n  updateClassNamespace(){\n        this.activeCard.namespace = `${this.defaultNamespace}${this.activeCard.prefix}/`;\n\n  }\n  updateInstanceList(classContext,predicate='rdf:type'){\n    let path = `${this.server}/lib/getList.sjs?context=${classContext}&predicate=${predicate}`\n    window.fetch(path)\n       .then((response)=>response.json())\n       .then((json)=>{\n          //console.log(classContext);\n          //console.log(json);\n          //if (!this.instanceList.hasOwnProperty(classContext)){this.instanceList[classContext]={};}\n          this.instanceList[classContext]={};\n          this.instanceList[classContext][predicate]=json;\n       });    \n  }\nfilterComplianceTest(){\n    let classContext = 'class:_ComplianceTest';\n    let predicate = 'rdf:type';\n    let path = `${this.server}/lib/getList.sjs?context=${classContext}&predicate=${predicate}`\n    let constraintObj = {constraints:[]};\n    if (this.complianceItem.country != \"\"){\n      constraintObj.constraints.push({predicate:'complianceTest:hasCountry',object:this.complianceItem.country});\n    }\n    if (this.complianceItem.industry != \"\"){\n      constraintObj.constraints.push({predicate:'complianceTest:hasIndustry',object:this.complianceItem.industry});\n    }\n    console.log(\"Entering Filter Compliance List\");\n    console.log(constraintObj);\n    window.fetch(path,{method:\"POST\",body:JSON.stringify(constraintObj,null,4)})\n       .then((response)=>response.json())\n       .then((json)=>{\n          //console.log(json);\n          //if (!this.instanceList.hasOwnProperty(classContext)){this.instanceList[classContext]={};}\n          this.instanceList[classContext]={};\n          this.instanceList[classContext][predicate]=json;\n       });    \n  }\n\n  getDescription(context,object,predicate){\n      if (context === null || object === null || predicate === null){return \"\"}\n      let item = this.instanceList[object][predicate].find((item)=>item.curie === context);\n      if (item != null){return item.description}\n        else {return \"\"}\n      }\n\n\n  getInstanceList(classContext,predicate='rdf:type'){\n     if (this.instanceList.hasOwnProperty(classContext) && this.instanceList[classContext].hasOwnProperty(predicate)){\n      return this.instanceList\n     }\n     else {\n      return []\n     }\n  }\n\n  summaryFilter(content,len=500){\n    content = content?content:\"\";\n    content = content.replace(/<.+?>/g,' ').replace(/\\s+/g,' ');\n    content = content.substr(0,len);\n    return content;\n  }\n\n  addProperty(){\n    //alert(\"Placeholder for add property.\")\n    let contextType = this.g[this.context]['rdf:type'][0].value;\n    let path = `${this.server}/lib/properties.sjs?type=${contextType}&cache=refresh`;\n    console.log(path);\n    fetch(path)\n    .then((response)=>response.json())\n    .then((json)=>{\n      this.availableProperties = json.results;\n      this.addPropertyModal.open();\n\n    })\n    .catch((e)=>console.log(e))\n  }\n  activePropertySelected(event){\n    let predicate = event.target.value;\n    this.activeProperty = this.availableProperties.find((property)=>property.predicate === predicate);\n    if (this.activeProperty.nodeKind === 'nodeKind:_IRI'){\n    let path = `${this.server}/lib/getList.sjs?context=${this.activeProperty.range}&cache=refresh`;\n    fetch(path)\n    .then((response)=>response.json())\n    .then((json)=>{\n      this.activePropertyValues=json;\n\n    })\n    .catch((e)=>console.log(e))\n\n     }\n\n  }\n\n  activeClassSelected(event){\n    console.log(event);\n  }\n\n  processAddProperty(){\n    console.log(this.activeProperty);\n    if (this.activeProperty.nodeKind==='nodeKind:_IRI'){\n      if (!this.g[this.context].hasOwnProperty(this.activeProperty.predicate)){\n        this.g[this.context][this.activeProperty.predicate] = [];\n        }\n      this.g[this.context][this.activeProperty.predicate].push({'type':'uri',value:this.activeProperty.value});\n      this.saveCardProperties();\n      }\n    if (this.activeProperty.nodeKind==='nodeKind:_Literal'){\n      if (!this.g[this.context].hasOwnProperty(this.activeProperty.predicate)){\n        this.g[this.context][this.activeProperty.predicate] = [];\n        }\n      this.g[this.context][this.activeProperty.predicate].push({'type':'literal',value:this.activeProperty.value,datatype:this.activeProperty.datatype});\n      this.saveCardProperties();\n      }\n  }\n  addExistingPropertyValue(property){\n    let newObject = Object.assign({},this.g[this.context][property][0]);\n    newObject.value = \"\";\n    newObject.label = \"\";\n    this.g[this.context][property].push(newObject);\n\n  }\n\n  newConstraint(){\n    //alert(\"Placeholder for add property.\")\n    let path = `${this.server}/lib/properties.sjs?type=${this.context}&cache=refresh`;\n    console.log(path);\n    fetch(path)\n    .then((response)=>response.json())\n    .then((json)=>{\n      this.availableProperties = json.results;\n      this.activeConstraint.predicate = \"\";\n      this.activeConstraint.object = \"\";\n      this.addConstraintModal.open();\n    })\n    .catch((e)=>console.log(e))\n    }\n\n  processAddConstraint(){\n//    console.log(this.activeProperty);\n    let constraint = Object.assign({},this.activeProperty);\n    if (constraint.nodeKind === \"nodeKind:_IRI\"){\n      let propertyValue = this.activePropertyValues.find((activePropertyValue)=>activePropertyValue.curie === constraint.value).label;\n      constraint.objectLabel = propertyValue;\n    }\n    this.constraints.push(constraint);\n    console.log(this.constraints);\n    this.fetchContext(this.context,\"list\");      \n  }\n  removeConstraint(index){\n    this.constraints.splice(index,1);\n    console.log(this.constraints);\n    this.cache=\"refresh\";\n    this.fetchContext(this.context,\"list\");\n  }\n\n  clearConstraints(){\n    this.constraints = [];\n    this.fetchContext(this.context,\"list\");\n  }\n  formatDoc(action,params={},gui=false){\n    let editor = document.querySelector('.bodyEditor');\n    document.execCommand(action,gui,params); editor.focus();\n  }\n  createHyperlink(){\n    var sLnk=prompt('Write the URL here','http://');\n    if(sLnk&&sLnk!=''&&sLnk!='http://'){\n       let editor = document.querySelector('.bodyEditor');\n       let selection = window.getSelection();\n       let text = selection.toString();\n       let link = `<a href=\"${sLnk}\" target=\"_blank\">${text}</a>`;\n       //this.formatDoc('insertHTML',link)}\n       document.execCommand('insertHTML',false,link); \n       editor.focus();\n     }\n  }\n  setForeColor(evt){\n    console.log(evt);\n    this.formatDoc('foreColor',evt.srcElement.value);\n  }\n  setBackColor(evt){\n    console.log(evt);\n    this.formatDoc('backColor',evt.srcElement.value);\n  }\n\n  setHeading(evt){\n    this.formatDoc('formatBlock',evt.srcElement.value);\n    evt.srcElement.value=\"\";\n  }\n  imageEdit(){\n//    this.editImageModal.open();\n      let selection = document.getSelection();\n      let imageNode = selection.anchorNode.querySelector(\"IMG\");\n      if (imageNode){\n        this.editImage = {\n          src:imageNode.getAttribute('src'),\n          width:imageNode.getAttribute('width'),\n          height:imageNode.getAttribute('height'),\n          alt:imageNode.getAttribute('alt')||\"\",\n          title:imageNode.getAttribute('title')||\"\",\n          align:imageNode.getAttribute('align')||\"\"\n        }\n      }\n      document.execCommand(\"insertHTML\",false,\"%^%\");\n      //this.editImageModal = document.querySelector('.editImageModal');\n      console.log(\"Enter imageEdit\");\n      this.editImageModal.open();\n      console.log(\"Leave imageEdit\");\n//      let url = prompt(\"Image URL\");\n//      this.processEditImage(url);\n  }\n\n  processEditImage(){\n    console.log(\"Entering processEditImage\");\n    //this.editImageModal.close();\n    let img = `<img src=\"${this.editImage.src}\" width=\"${this.editImage.width}\" height=\"${this.editImage.height}\"\n    alt=\"${this.editImage.alt}\" title=\"${this.editImage.title}\" style=\"${this.editImage.align}\"/>`;\n    console.log(img);\n    let editor = document.querySelector('.bodyEditor');\n    editor.focus();\n    //document.execCommand(\"insertHTML\",false,img);\n    let html = editor.innerHTML;\n    editor.innerHTML = html.replace(\"%^%\",img)\n\n    //editor.focus();\n    console.log(\"Leaving processEditImage\");\n  }\n  cancelEditImage(){\n    this.editImageModal.cancel();\n    let editor = document.querySelector('.bodyEditor');\n    //document.execCommand(\"insertHTML\",false,img);\n    let html = editor.innerHTML;\n    editor.innerHTML = html.replace(\"%^%\",\"\")\n\n  }\n\n insertTermDlg(){\n    this.insertTermObj = {label:\"\",value:\"\",temp:\"\",asImage:false,image:\"\"};\n    let editor = document.querySelector('.bodyEditor');\n    let selection = window.getSelection();\n    this.q = selection.toString();\n    this.insertTermObj.temp = selection.toString();\n    this.insertTermObj.label = selection.toString();\n    this.formatDoc('insertHTML',\"%^%\");\n    this.inputSearch()\n    this.insertTermModal.open()\n }\n\n insertTerm(){\n  console.log(\"Entering insertTerm()\");\n  this.q = \"\";\n  let label = this.insertTermObj.temp;\n  console.log(this.insertTermObj.asImage);\n  let link = (this.insertTermObj.asImage===\"image\")?`\n     <div class=\"insertedImageContainer\">\n        <a href=\"/?context=${this.insertTermObj.value}\" class=\"link\"  resource=\"${this.insertTermObj.value}\" property=\"term:hasInternalTerm\">\n          <img src=\"${this.insertTermObj.image}\" class=\"insertedImage\"/>\n          <div class=\"imageCaption\">${this.insertTermObj.temp}</div>\n        </a>\n      </div>`:`<a href=\"/?context=${this.insertTermObj.value}\" class=\"link\" resource=\"${this.insertTermObj.value}\" \n      property=\"term:hasInternalTerm\">${label}</a>`;\n  let editor = document.querySelector('.bodyEditor');\n  let html = editor.innerHTML;\n  editor.innerHTML = html.replace(\"%^%\",link)\n  editor.focus();\n }\n\n cancelInsertTerm(){\n  this.q = \"\";\n  let link = this.insertTermObj.temp;\n  let editor = document.querySelector('.bodyEditor');\n  let html = editor.innerHTML;\n  editor.innerHTML = html.replace(\"%^%\",link)\n  //this.insertTermModal.cancel()\n  editor.focus();  \n }\n updateInsertTerm(){\n  let searchItem = this.searchData.results.find((searchItem)=>searchItem.s === this.insertTermObj.value);\n  this.insertTermObj.temp = searchItem.prefLabel;  \n }\n\n  updateInsertImage(){\n  let searchItem = this.searchData.results.find((searchItem)=>searchItem.s === this.insertTermObj.value);\n  this.insertTermObj.image = searchItem.imageURL;\n }\n\n insertCodeBlock(){\n     let editor = document.querySelector('.bodyEditor');\n     editor.focus();\n     document.execCommand('insertHTML',false,'<pre class=\"codeBlock\"># Insert Code Here</pre>');\n }\n\n  hasContent(context,property){\n    //console.log(context,property);\n    return (property === 'link')?true:!this.g[context][property][0].value.match(/\\:_$/)\n  }\n  deleteClassItems(clearClass=false){\n    let message = clearClass?`Warning! This will delete the class \"${this.g[this.context]['term:prefLabel'][0].value}\", all properties for that class and all items in the class. It can not be undone. Are you sure you want to continue?`:`Warning! This will remove all items from this class (but keep class and properties). It cannot be undone. Are you sure you want to continue?`;\n    if (confirm(message)){\n      console.log(\"Delete class items\");\n      let path = `${this.server}/lib/deleteClassItems.sjs?context=${this.context}&removeClass=${clearClass?'true':'false'}`;\n      window.fetch(path)\n      .then((response)=>response.text())\n      .then((text)=>{\n          this.cache = \"refresh\";\n          this.fetchContext(\"class:_Class\",'list')\n          })\n      .catch((e)=>console.log(e))\n    }\n  }\n  log(content){\n    console.log(content);\n    return content\n  }\n\n  setImage(event){\n//    console.log(event);\n    //console.log(event.target.value)\n    let file = event.srcElement.files[0];\n    let reader = new FileReader();\n    let target = this.activeCard;\n    let me = this;\n    reader.addEventListener(\"load\", function () {\n      target.image = reader.result;\n      me.createImageFile();\n  }, false);\n    reader.readAsDataURL(file);\n    //this.activeCard.image = window.URL.createObjectURL(file);\n  }\n\n  createImageFile(id=this.activeCard.curie){\n    let url = this.activeCard.image;\n    if (url.startsWith('data:image')){\n       let type=url.replace(/^data:image\\/(\\w+)\\;.*/,'$1');\n       let data = url.split(';base64,')[1];\n       let options = {\"method\":\"POST\",body:JSON.stringify({imageData:data,imageType:type,id:id},null,4)}\n       let target = this.activeCard;\n       window.fetch(`${this.server}/lib/uploadImage.sjs`,options)\n       .then((resp)=>resp.json())\n       .then((json)=>{\n          let path = `${this.server}/lib/getImage.sjs?path=${json.filepath}`;\n          target.image = path;\n        })\n       .catch((e)=>console.log(e))\n    }\n  }\n  loadBlocks(){\n    this.blocks=[\n{\n      type:\"sp\",\n      predicate:'document:hasAuthor',\n      selector:'byline',\n      html:``,\n      container:'leftPane',\n      header:`<h2>Author(s)</h2>`,\n      footer:``,\n      css:`.authorEntry {padding-bottom:10pt;}\n      .authorImage {\n        width:90%;\n        height:auto;\n        margin-right:10px;\n        margin-bottom:10px;}\n      .jobTitle {font-size:10pt;font-style:italic;}\n      `,\n      template:(context,graph) =>`<div onclick=\"window.app.fetchContext('${context}')\" class=\"authorEntry\">\n        <img src=\"${graph[context]['term:hasPrimaryImageURL'][0].value}\" class=\"authorImage\"/>\n        <div class=\"link\">${graph[context]['term:prefLabel'][0].value}</div>\n        <div class=\"jobTitle\">${graph[context]['author:hasTitle'][0].value}</div>\n        </div>`\n    },\n{\n      type:\"sp\",\n      predicate:'document:hasAuthor',\n      selector:'aboutAuthor',\n      html:``,\n      container:\"centerPaneAddons\",\n      header:``,\n      footer:``,\n      css:`.aboutAuthor_1 {\n        padding-bottom:10pt;\n        display:flex;\n        flex-direction:row;\n        padding-top:20px;\n      }\n      .authorImage2 {\n        width:90%;\n        height:auto;\n        border:inset 10px lightGray;\n        border-radius:20px;\n\n      }\n      .imageContainer2 {\n        display:block;\n        width:30%;\n        padding:15px;\n      }\n      .authorDescription {font-size:10pt;font-style:italic;display:block;width:70%}\n      `,\n      template:(context,graph) =>`<div onclick=\"window.app.fetchContext('${context}')\" class=\"aboutAuthor_1\">\n        <div class=\"imageContainer2\"><img src=\"${graph[context]['term:hasPrimaryImageURL'][0].value}\" class=\"authorImage2\"/></div>\n        <div class=\"authorDescription\">\n        ${graph[context]['term:hasDescription'][0].value}</div>\n        </div>`\n    },\n    {\n      type:\"self\",\n      predicate:\"document:hasTopic\",\n      selector:'topics',\n      separator:', ',\n      html:``,\n      container:'leftPane',\n      header:`<h2>Topic(s)</h2>`,\n      footer:``,\n      css:``,\n      template:(context,graph,index,count) =>`<span onclick=\"window.app.fetchContext('${context}')\" class=\"topic link\">${graph[context]['term:prefLabel'][0].value}</span>`\n    } ,\n    {\n      type:\"self\",\n      predicate:\"page:hasPreviousPage\",\n      selector:'previousPage',\n      separator:'',\n      html:``,\n      container:'leftPane',\n      header:``,\n      footer:``,\n      css:``,\n      template:(context,graph,index,count) =>`<span onclick=\"window.app.fetchContext('${context}')\" class=\"link\">${graph[context]['term:prefLabel'][0].value}</span>`\n    } \n    ]\n\n  }\nrefreshBlocks(){\n    this.blocks.forEach((block)=>{\n      let container = document.querySelector(`.${block.container}`);\n      if (container != null){\n        container.innerHTML = \" \";\n      }\n    })\n    this.blocks.forEach((block)=>{\n      let container = document.querySelector(`.${block.container}`);\n      if (container!=null){\n      if (!container.querySelector(`.${block.selector}`))\n      {\n        container.innerHTML += `<div class=\"${block.selector}\"> </div>`\n      }\n      block.html = `<style type=\"text/css\">${block.css}</style><div class=\"block\">${block.header}`;\n      let targets = Array.from(document.querySelectorAll(`.${block.selector}`));\n      targets.forEach((target)=>target.innerHTML = \"\");\n      console.log(block);\n      if (block.type === \"sp\"){\n        if (this.g[this.context].hasOwnProperty(block.predicate)){\n          let count = this.g[this.context][block.predicate].length;\n          let index = -1;\n          let contexts = this.g[this.context][block.predicate].map((object)=>object.value);\n          contexts.forEach((context)=>{\n          //block.html = block.header;\n          window.fetch(`${this.server}/lib/server.sjs?context=${context}`)\n          .then((response)=>response.json())\n          .then((json)=>{\n            let graph = json.graph;\n            block.html += block.template(context,graph,index,count);\n            index += 1;\n          })\n          .then(()=>{\n              let targets = Array.from(document.querySelectorAll(`.${block.selector}`));\n              if (index + 1 === count){\n                block.html += `${block.footer}</div>`;\n                //console.log(block.html);\n                targets.forEach((target)=>{\n                   target.innerHTML = block.html;\n                  \n              })\n            }\n          })\n      })\n    }\n  }\n      if (block.type === \"self\"){\n        console.log(\"Entering self\");\n        if (this.g[this.context].hasOwnProperty(block.predicate)){\n          console.log(this.g[this.context][block.predicate]);\n          let count = this.g[this.context][block.predicate].length;\n          let index = -1;          \n          let graph = this.g;\n          let contexts = this.g[this.context][block.predicate].map((object)=>object.value);\n          block.html += contexts.map((context)=>!this.isNullLink(context)?block.template(context,graph,index,count):'').join(block.separator);\n          block.html += `${block.footer}</div>`;\n          targets.forEach((target)=>{\n             target.innerHTML = block.html;\n          }) \n\n        }\n      }\n    }\n    })\n  }\n  isNullLink(context){\n    return (context.match(/:_$/))\n  }\n  getValidLink(context,property){\n    if (this.g[context].hasOwnProperty(property)){\n      let validLink = this.g[context][property].find((value)=>!this.isNullLink(value));\n      return validLink;\n    }\n    else {return false;}\n  }\n}\n\n","\r\n// A ValueConverter for iterating an Object's properties inside of a repeat.for in Aurelia\r\nexport class SortedObjectKeysValueConverter {\r\n    toView(obj) {\r\n        // Create a temporary array to populate with object keys\r\n        let temp = [];\r\n        \r\n        // A basic for..in loop to get object properties\r\n        // https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/for...in\r\n        for (let prop in obj) {\r\n            if (obj.hasOwnProperty(prop)) {\r\n                temp.push(prop);\r\n            }\r\n        }\r\n        temp.sort();\r\n        return temp;\r\n    }\r\n}\r\n\r\n/**\r\n * Usage\r\n * Shows how to use the custom ValueConverter to iterate an objects properties\r\n * aka its keys.\r\n * \r\n * <require from=\"ObjectKeys\"></require>\r\n * <li repeat.for=\"prop of myVmObject | objectKeys\">${prop}</li>\r\n */","\r\n// A ValueConverter for iterating an Object's properties inside of a repeat.for in Aurelia\r\nexport class ObjectKeysValueConverter {\r\n    toView(obj) {\r\n        // Create a temporary array to populate with object keys\r\n        let temp = [];\r\n        \r\n        // A basic for..in loop to get object properties\r\n        // https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/for...in\r\n        for (let prop in obj) {\r\n            if (obj.hasOwnProperty(prop)) {\r\n                temp.push(prop);\r\n            }\r\n        }\r\n        \r\n        return temp;\r\n    }\r\n}\r\n\r\n/**\r\n * Usage\r\n * Shows how to use the custom ValueConverter to iterate an objects properties\r\n * aka its keys.\r\n * \r\n * <require from=\"ObjectKeys\"></require>\r\n * <li repeat.for=\"prop of myVmObject | objectKeys\">${prop}</li>\r\n */"],"sourceRoot":".."}